(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-422e04f4"],{1148:function(e,t,s){"use strict";var a=s("a691"),o=s("1d80");e.exports="".repeat||function(e){var t=String(o(this)),s="",n=a(e);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(s+=t);return s}},"1c4d":function(e,t,s){},"257e":function(e,t,s){"use strict";s("d017")},"408a":function(e,t,s){var a=s("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=a(e))throw TypeError("Incorrect invocation");return+e}},"4da4":function(e,t,s){},7317:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{id:"CommonChannelEdit"}},[s("el-form",{ref:"passwordForm",staticClass:"channel-form",attrs:{"status-icon":"","label-width":"160px"}},[s("div",{staticClass:"form-box"},[s("el-form-item",{attrs:{label:"名称"}},[s("el-input",{attrs:{placeholder:"请输入通道名称"},model:{value:e.form.gbName,callback:function(t){e.$set(e.form,"gbName",t)},expression:"form.gbName"}})],1),s("el-form-item",{attrs:{label:"编码"}},[s("el-input",{attrs:{placeholder:"请输入通道编码"},scopedSlots:e._u([{key:"append",fn:function(){return[s("el-button",{on:{click:function(t){return e.buildDeviceIdCode(e.form.gbDeviceId)}}},[e._v("生成")])]},proxy:!0}]),model:{value:e.form.gbDeviceId,callback:function(t){e.$set(e.form,"gbDeviceId",t)},expression:"form.gbDeviceId"}})],1),s("el-form-item",{attrs:{label:"设备厂商"}},[s("el-input",{attrs:{placeholder:"请输入设备厂商"},model:{value:e.form.gbManufacturer,callback:function(t){e.$set(e.form,"gbManufacturer",t)},expression:"form.gbManufacturer"}})],1),s("el-form-item",{attrs:{label:"设备型号"}},[s("el-input",{attrs:{placeholder:"请输入设备型号"},model:{value:e.form.gbModel,callback:function(t){e.$set(e.form,"gbModel",t)},expression:"form.gbModel"}})],1),s("el-form-item",{attrs:{label:"行政区域"}},[s("el-input",{attrs:{placeholder:"请输入行政区域"},scopedSlots:e._u([{key:"append",fn:function(){return[s("el-button",{on:{click:function(t){return e.chooseCivilCode()}}},[e._v("选择")])]},proxy:!0}]),model:{value:e.form.gbCivilCode,callback:function(t){e.$set(e.form,"gbCivilCode",t)},expression:"form.gbCivilCode"}})],1),s("el-form-item",{attrs:{label:"安装地址"}},[s("el-input",{attrs:{placeholder:"请输入安装地址"},model:{value:e.form.gbAddress,callback:function(t){e.$set(e.form,"gbAddress",t)},expression:"form.gbAddress"}})],1),s("el-form-item",{attrs:{label:"子设备"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择是否有子设备"},model:{value:e.form.gbParental,callback:function(t){e.$set(e.form,"gbParental",t)},expression:"form.gbParental"}},[s("el-option",{attrs:{label:"有",value:1}}),s("el-option",{attrs:{label:"无",value:0}})],1)],1),s("el-form-item",{attrs:{label:"父节点编码"}},[s("el-input",{attrs:{placeholder:"请输入父节点编码或选择所属虚拟组织"},scopedSlots:e._u([{key:"append",fn:function(){return[s("el-button",{on:{click:function(t){return e.chooseGroup()}}},[e._v("选择")])]},proxy:!0}]),model:{value:e.form.gbParentId,callback:function(t){e.$set(e.form,"gbParentId",t)},expression:"form.gbParentId"}})],1),s("el-form-item",{attrs:{label:"设备状态"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择设备状态"},model:{value:e.form.gbStatus,callback:function(t){e.$set(e.form,"gbStatus",t)},expression:"form.gbStatus"}},[s("el-option",{attrs:{label:"在线",value:"ON"}}),s("el-option",{attrs:{label:"离线",value:"OFF"}})],1)],1),s("el-form-item",{attrs:{label:"经度"}},[s("el-input",{attrs:{placeholder:"请输入经度"},model:{value:e.form.gbLongitude,callback:function(t){e.$set(e.form,"gbLongitude",t)},expression:"form.gbLongitude"}})],1),s("el-form-item",{attrs:{label:"纬度"}},[s("el-input",{attrs:{placeholder:"请输入纬度"},model:{value:e.form.gbLatitude,callback:function(t){e.$set(e.form,"gbLatitude",t)},expression:"form.gbLatitude"}})],1),s("el-form-item",{attrs:{label:"云台类型"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择云台类型"},model:{value:e.form.gbPtzType,callback:function(t){e.$set(e.form,"gbPtzType",t)},expression:"form.gbPtzType"}},[s("el-option",{attrs:{label:"球机",value:1}}),s("el-option",{attrs:{label:"半球",value:2}}),s("el-option",{attrs:{label:"固定枪机",value:3}}),s("el-option",{attrs:{label:"遥控枪机",value:4}}),s("el-option",{attrs:{label:"遥控半球",value:5}}),s("el-option",{attrs:{label:"多目设备的全景/拼接通道",value:6}}),s("el-option",{attrs:{label:"多目设备的分割通道",value:7}})],1)],1)],1),s("div",[s("el-form-item",{attrs:{label:"警区"}},[s("el-input",{attrs:{placeholder:"请输入警区"},model:{value:e.form.gbBlock,callback:function(t){e.$set(e.form,"gbBlock",t)},expression:"form.gbBlock"}})],1),s("el-form-item",{attrs:{label:"设备归属"}},[s("el-input",{attrs:{placeholder:"请输入设备归属"},model:{value:e.form.gbOwner,callback:function(t){e.$set(e.form,"gbOwner",t)},expression:"form.gbOwner"}})],1),s("el-form-item",{attrs:{label:"信令安全模式"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择信令安全模式"},model:{value:e.form.gbSafetyWay,callback:function(t){e.$set(e.form,"gbSafetyWay",t)},expression:"form.gbSafetyWay"}},[s("el-option",{attrs:{label:"不采用",value:0}}),s("el-option",{attrs:{label:"S/MIME签名",value:2}}),s("el-option",{attrs:{label:"S/MIME加密签名同时采用",value:3}}),s("el-option",{attrs:{label:"数字摘要",value:4}})],1)],1),s("el-form-item",{attrs:{label:"注册方式"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择注册方式"},model:{value:e.form.gbRegisterWay,callback:function(t){e.$set(e.form,"gbRegisterWay",t)},expression:"form.gbRegisterWay"}},[s("el-option",{attrs:{label:"IETFRFC3261标准",value:1}}),s("el-option",{attrs:{label:"基于口令的双向认证",value:2}}),s("el-option",{attrs:{label:"基于数字证书的双向认证注册",value:3}})],1)],1),s("el-form-item",{attrs:{label:"证书序列号"}},[s("el-input",{attrs:{type:"number",placeholder:"请输入证书序列号"},model:{value:e.form.gbCertNum,callback:function(t){e.$set(e.form,"gbCertNum",t)},expression:"form.gbCertNum"}})],1),s("el-form-item",{attrs:{label:"证书有效标识"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择证书有效标识"},model:{value:e.form.gbCertifiable,callback:function(t){e.$set(e.form,"gbCertifiable",t)},expression:"form.gbCertifiable"}},[s("el-option",{attrs:{label:"有效",value:1}}),s("el-option",{attrs:{label:"无效",value:0}})],1)],1),s("el-form-item",{attrs:{label:"无效原因码"}},[s("el-input",{attrs:{type:"errCode",placeholder:"请输入无效原因码"},model:{value:e.form.gbCertNum,callback:function(t){e.$set(e.form,"gbCertNum",t)},expression:"form.gbCertNum"}})],1),s("el-form-item",{attrs:{label:"证书终止有效期"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.form.gbEndTime,callback:function(t){e.$set(e.form,"gbEndTime",t)},expression:"form.gbEndTime"}})],1),s("el-form-item",{attrs:{label:"保密属性"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择保密属性"},model:{value:e.form.gbSecrecy,callback:function(t){e.$set(e.form,"gbSecrecy",t)},expression:"form.gbSecrecy"}},[s("el-option",{attrs:{label:"不涉密",value:0}}),s("el-option",{attrs:{label:"涉密",value:1}})],1)],1),s("el-form-item",{attrs:{label:"IP地址"}},[s("el-input",{attrs:{placeholder:"请输入IP地址"},model:{value:e.form.gbIpAddress,callback:function(t){e.$set(e.form,"gbIpAddress",t)},expression:"form.gbIpAddress"}})],1),s("el-form-item",{attrs:{label:"端口"}},[s("el-input",{attrs:{type:"number",placeholder:"请输入端口"},model:{value:e.form.gbPort,callback:function(t){e.$set(e.form,"gbPort",t)},expression:"form.gbPort"}})],1),s("el-form-item",{attrs:{label:"设备口令"}},[s("el-input",{attrs:{placeholder:"请输入设备口令"},model:{value:e.form.gbPassword,callback:function(t){e.$set(e.form,"gbPassword",t)},expression:"form.gbPassword"}})],1)],1),s("div",[s("el-form-item",{attrs:{label:"业务分组编号"}},[s("el-input",{attrs:{placeholder:"请输入业务分组编号"},model:{value:e.form.gbBusinessGroupId,callback:function(t){e.$set(e.form,"gbBusinessGroupId",t)},expression:"form.gbBusinessGroupId"}})],1),s("el-form-item",{attrs:{label:"位置类型"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择位置类型"},model:{value:e.form.gbPositionType,callback:function(t){e.$set(e.form,"gbPositionType",t)},expression:"form.gbPositionType"}},[s("el-option",{attrs:{label:"省际检查站",value:1}}),s("el-option",{attrs:{label:"党政机关",value:2}}),s("el-option",{attrs:{label:"车站码头",value:3}}),s("el-option",{attrs:{label:"中心广场",value:4}}),s("el-option",{attrs:{label:"体育场馆",value:5}}),s("el-option",{attrs:{label:"商业中心",value:6}}),s("el-option",{attrs:{label:"宗教场所",value:7}}),s("el-option",{attrs:{label:"校园周边",value:8}}),s("el-option",{attrs:{label:"治安复杂区域",value:9}}),s("el-option",{attrs:{label:"交通干线",value:10}})],1)],1),s("el-form-item",{attrs:{label:"室外/室内"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择位置类型"},model:{value:e.form.gbRoomType,callback:function(t){e.$set(e.form,"gbRoomType",t)},expression:"form.gbRoomType"}},[s("el-option",{attrs:{label:"室外",value:1}}),s("el-option",{attrs:{label:"室内",value:2}})],1)],1),s("el-form-item",{attrs:{label:"用途"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择位置类型"},model:{value:e.form.gbUseType,callback:function(t){e.$set(e.form,"gbUseType",t)},expression:"form.gbUseType"}},[s("el-option",{attrs:{label:"治安",value:1}}),s("el-option",{attrs:{label:"交通",value:2}}),s("el-option",{attrs:{label:"重点",value:3}})],1)],1),s("el-form-item",{attrs:{label:"补光"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择位置类型"},model:{value:e.form.gbSupplyLightType,callback:function(t){e.$set(e.form,"gbSupplyLightType",t)},expression:"form.gbSupplyLightType"}},[s("el-option",{attrs:{label:"无补光",value:1}}),s("el-option",{attrs:{label:"红外补光",value:2}}),s("el-option",{attrs:{label:"白光补光",value:3}}),s("el-option",{attrs:{label:"激光补光",value:4}}),s("el-option",{attrs:{label:"其他",value:9}})],1)],1),s("el-form-item",{attrs:{label:"监视方位"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择位置类型"},model:{value:e.form.gbDirectionType,callback:function(t){e.$set(e.form,"gbDirectionType",t)},expression:"form.gbDirectionType"}},[s("el-option",{attrs:{label:"东(西向东)",value:1}}),s("el-option",{attrs:{label:"西(东向西)",value:2}}),s("el-option",{attrs:{label:"南(北向南)",value:3}}),s("el-option",{attrs:{label:"北(南向北)",value:4}}),s("el-option",{attrs:{label:"东南(西北到东南)",value:5}}),s("el-option",{attrs:{label:"东北(西南到东北)",value:6}}),s("el-option",{attrs:{label:"西南(东北到西南)",value:7}}),s("el-option",{attrs:{label:"西北(东南到西北)",value:8}})],1)],1),s("el-form-item",{attrs:{label:"分辨率"}},[s("el-input",{attrs:{placeholder:"请输入分辨率"},model:{value:e.form.gbResolution,callback:function(t){e.$set(e.form,"gbResolution",t)},expression:"form.gbResolution"}})],1),s("el-form-item",{attrs:{label:"下载倍速"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择位置类型"},model:{value:e.form.gbDownloadSpeedArray,callback:function(t){e.$set(e.form,"gbDownloadSpeedArray",t)},expression:"form.gbDownloadSpeedArray"}},[s("el-option",{attrs:{label:"1倍速",value:"1"}}),s("el-option",{attrs:{label:"2倍速",value:"2"}}),s("el-option",{attrs:{label:"4倍速",value:"4"}}),s("el-option",{attrs:{label:"8倍速",value:"8"}}),s("el-option",{attrs:{label:"16倍速",value:"16"}})],1)],1),s("el-form-item",{attrs:{label:"空域编码能力"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择空域编码能力"},model:{value:e.form.gbSvcSpaceSupportMod,callback:function(t){e.$set(e.form,"gbSvcSpaceSupportMod",t)},expression:"form.gbSvcSpaceSupportMod"}},[s("el-option",{attrs:{label:"1级增强",value:"1"}}),s("el-option",{attrs:{label:"2级增强",value:"2"}}),s("el-option",{attrs:{label:"3级增强",value:"3"}})],1)],1),s("el-form-item",{attrs:{label:"时域编码能力"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择空域编码能力"},model:{value:e.form.gbSvcTimeSupportMode,callback:function(t){e.$set(e.form,"gbSvcTimeSupportMode",t)},expression:"form.gbSvcTimeSupportMode"}},[s("el-option",{attrs:{label:"1级增强",value:"1"}}),s("el-option",{attrs:{label:"2级增强",value:"2"}}),s("el-option",{attrs:{label:"3级增强",value:"3"}})],1)],1),s("div",{staticStyle:{float:"right"}},[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")]),e.cancel?s("el-button",{on:{click:e.cancelSubmit}},[e._v("取消")]):e._e(),1===e.form.dataType?s("el-button",{on:{click:e.reset}},[e._v("重置")]):e._e()],1)],1)]),s("channelCode",{ref:"channelCode"}),s("chooseCivilCode",{ref:"chooseCivilCode"}),s("chooseGroup",{ref:"chooseGroup"})],1)},o=[],n=(s("a15b"),s("d3b7"),s("165c")),i=s("363b"),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"chooseGroup"}},[s("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"选择虚拟组织",width:"30%",top:"5rem","append-to-body":!0,"close-on-click-modal":!1,visible:e.showDialog,"destroy-on-close":!0},on:{"update:visible":function(t){e.showDialog=t},close:function(t){return e.close()}}},[s("GroupTree",{ref:"regionTree",attrs:{"show-header":!0,edit:!0,"enable-add-channel":!1,"click-event":e.treeNodeClickEvent,"on-channel-change":e.onChannelChange,"tree-height":"45vh"}}),s("el-form",[s("el-form-item",[s("div",{staticStyle:{"text-align":"right"}},[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")]),s("el-button",{on:{click:e.close}},[e._v("取消")])],1)])],1)],1)],1)},l=[],c=s("a888"),d=s("c2c8"),u={name:"ChooseCivilCode",directives:{elDragDialog:c["a"]},components:{GroupTree:d["a"]},props:{},data:function(){return{showDialog:!1,endCallback:!1,groupDeviceId:"",businessGroup:""}},computed:{},created:function(){},methods:{openDialog:function(e){this.showDialog=!0,this.endCallback=e},onSubmit:function(){this.endCallback&&this.endCallback(this.groupDeviceId,this.businessGroup),this.close()},close:function(){this.showDialog=!1},treeNodeClickEvent:function(e){""!==e.deviceId&&e.deviceId!==e.businessGroup&&(this.groupDeviceId=e.deviceId,this.businessGroup=e.businessGroup)},onChannelChange:function(e){}}},m=u,p=s("2877"),h=Object(p["a"])(m,r,l,!1,null,null,null),f=h.exports,b={name:"CommonChannelEdit",components:{ChooseCivilCode:i["a"],ChooseGroup:f,channelCode:n["a"]},props:["id","dataForm","saveSuccess","cancel"],data:function(){return{loading:!1,form:{}}},created:function(){this.id?this.getCommonChannel():(this.dataForm.gbDeviceId||(this.dataForm.gbDeviceId=""),console.log(this.dataForm),this.form=this.dataForm)},methods:{onSubmit:function(){var e=this;this.loading=!0,this.form.gbDownloadSpeedArray&&(this.form.gbDownloadSpeed=this.form.gbDownloadSpeedArray.join("/")),this.form.gbId?this.$store.dispatch("commonChanel/update",this.form).then((function(t){e.$message.success({showClose:!0,message:"保存成功"}),e.saveSuccess&&e.saveSuccess()})).finally((function(){return[e.loading=!1]})):this.$store.dispatch("commonChanel/add",this.form).then((function(t){e.$message.success({showClose:!0,message:"保存成功"}),e.saveSuccess&&e.saveSuccess()})).finally((function(){return[e.loading=!1]}))},reset:function(){var e=this;this.$confirm("确定重置为默认内容?","提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,e.$axios({method:"post",url:"/api/common/channel/reset",params:{id:e.form.gbId}}).then((function(t){0===t.data.code&&(e.$message.success({showClose:!0,message:"重置成功 已保存"}),e.getCommonChannel())})).catch((function(e){console.error(e)})).finally((function(){return[e.loading=!1]}))})).catch((function(){}))},getCommonChannel:function(){var e=this;this.loading=!0,this.$store.dispatch("commonChanel/queryOne",this.id).then((function(t){t.gbDownloadSpeed&&(t.gbDownloadSpeedArray=t.gbDownloadSpeed.split("/")),e.form=t})).finally((function(){e.loading=!1}))},buildDeviceIdCode:function(e){var t=this;this.$refs.channelCode.openDialog((function(e){console.log(t.form),console.log("code===> "+e),t.form.gbDeviceId=e,console.log("code22===> "+e)}),e)},chooseCivilCode:function(){var e=this;this.$refs.chooseCivilCode.openDialog((function(t){e.form.gbCivilCode=t}))},chooseGroup:function(){var e=this;this.$refs.chooseGroup.openDialog((function(t,s){e.form.gbBusinessGroupId=s,e.form.gbParentId=t}))},cancelSubmit:function(){this.cancel&&this.cancel()}}},g=b,v=(s("257e"),Object(p["a"])(g,a,o,!1,null,null,null));t["a"]=v.exports},8754:function(e,t,s){"use strict";s("1c4d")},"904f":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container",staticStyle:{height:"calc(100vh - 124px)"},attrs:{id:"channelList"}},[e.editId?e._e():s("div",{staticStyle:{height:"100%"}},[s("el-form",{attrs:{inline:!0,size:"mini"}},[s("el-form-item",{attrs:{label:"搜索"}},[s("el-input",{staticStyle:{"margin-right":"1rem",width:"auto"},attrs:{placeholder:"关键字","prefix-icon":"el-icon-search",clearable:""},on:{input:e.search},model:{value:e.searchStr,callback:function(t){e.searchStr=t},expression:"searchStr"}})],1),s("el-form-item",{attrs:{label:"在线状态"}},[s("el-select",{staticStyle:{width:"8rem","margin-right":"1rem"},attrs:{placeholder:"请选择","default-first-option":""},on:{change:e.search},model:{value:e.online,callback:function(t){e.online=t},expression:"online"}},[s("el-option",{attrs:{label:"全部",value:""}}),s("el-option",{attrs:{label:"在线",value:"true"}}),s("el-option",{attrs:{label:"离线",value:"false"}})],1)],1),s("el-form-item",{attrs:{label:"类型"}},[s("el-select",{staticStyle:{width:"8rem","margin-right":"1rem"},attrs:{placeholder:"请选择","default-first-option":""},on:{change:e.getChannelList},model:{value:e.channelType,callback:function(t){e.channelType=t},expression:"channelType"}},[s("el-option",{attrs:{label:"全部",value:""}}),e._l(Object.values(e.$channelTypeList),(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1),s("el-form-item",{staticStyle:{float:"right"}},[s("el-button",{attrs:{icon:"el-icon-refresh-right",circle:"",title:"刷新表格"},on:{click:function(t){return e.refresh()}}})],1)],1),s("el-table",{ref:"channelListTable",staticStyle:{width:"100%","font-size":"12px"},attrs:{size:"small",data:e.channelList,height:"calc(100% - 64px)","header-row-class-name":"table-header"}},[s("el-table-column",{attrs:{prop:"gbName",label:"名称","min-width":"180"}}),s("el-table-column",{attrs:{prop:"gbDeviceId",label:"编号","min-width":"180"}}),s("el-table-column",{attrs:{prop:"gbManufacturer",label:"厂家","min-width":"100"}}),s("el-table-column",{attrs:{label:"类型","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[s("el-tag",{style:e.$channelTypeList[t.row.dataType].style,attrs:{size:"medium",effect:"plain",type:"success"}},[e._v(e._s(e.$channelTypeList[t.row.dataType].name))])],1)]}}],null,!1,3268672348)}),s("el-table-column",{attrs:{label:"位置信息","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.gbLongitude&&t.row.gbLatitude?s("span",[e._v(e._s(t.row.gbLongitude)),s("br"),e._v(e._s(t.row.gbLatitude))]):e._e(),t.row.gbLongitude&&t.row.gbLatitude?e._e():s("span",[e._v("无")])]}}],null,!1,1442022050)}),s("el-table-column",{attrs:{prop:"ptzType",label:"云台类型","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[e._v(e._s(t.row.ptzTypeText))])]}}],null,!1,867005290)}),s("el-table-column",{attrs:{label:"状态","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},["ON"===t.row.gbStatus?s("el-tag",{attrs:{size:"medium"}},[e._v("在线")]):e._e(),"ON"!==t.row.gbStatus?s("el-tag",{attrs:{size:"medium",type:"info"}},[e._v("离线")]):e._e()],1)]}}],null,!1,752981929)}),s("el-table-column",{attrs:{label:"操作","min-width":"210",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"medium",disabled:"ON"!==t.row.gbStatus,icon:"el-icon-video-play",type:"text",loading:t.row.playLoading},on:{click:function(s){return e.sendDevicePush(t.row)}}},[e._v("播放 ")]),t.row.streamId?s("el-button",{staticStyle:{color:"#f56c6c"},attrs:{size:"medium",icon:"el-icon-switch-button",type:"text"},on:{click:function(s){return e.stopDevicePush(t.row)}}},[e._v("停止 ")]):e._e(),s("el-divider",{attrs:{direction:"vertical"}}),2!==e.$store.getters.authority?s("el-button",{attrs:{size:"medium",type:"text",icon:"el-icon-edit"},on:{click:function(s){return e.handleEdit(t.row)}}},[e._v(" 编辑 ")]):e._e(),s("el-divider",{attrs:{direction:"vertical"}}),s("el-dropdown",{on:{command:function(s){e.moreClick(s,t.row)}}},[s("el-button",{attrs:{size:"medium",type:"text"}},[e._v(" 更多"),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),s("el-dropdown-menu",[s("el-dropdown-item",{attrs:{command:"records",disabled:"ON"!==t.row.gbStatus}},[e._v(" 设备录像")]),s("el-dropdown-item",{attrs:{command:"cloudRecords",disabled:"ON"!==t.row.gbStatus}},[e._v(" 云端录像")])],1)],1)]}}],null,!1,1761284053)})],1),s("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.currentPage,"page-size":e.count,"page-sizes":[15,25,35,50],layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.currentChange}})],1),s("devicePlayer",{ref:"devicePlayer"}),e.editId?s("channel-edit",{attrs:{id:e.editId,"close-edit":e.closeEdit}}):e._e()],1)},o=[],n=(s("99af"),s("b0c0"),s("a9e3"),s("d3b7"),s("0643"),s("4e3e"),s("159b"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoging,expression:"isLoging"}],attrs:{id:"devicePlayer"}},[e.showVideoDialog?s("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"视频播放",top:"0","close-on-click-modal":!1,visible:e.showVideoDialog},on:{"update:visible":function(t){e.showVideoDialog=t},close:function(t){return e.close()}}},[s("div",{staticStyle:{width:"100%",height:"100%"}},[Object.keys(this.player).length>1?s("el-tabs",{attrs:{type:"card",stretch:!0},on:{"tab-click":e.changePlayer},model:{value:e.activePlayer,callback:function(t){e.activePlayer=t},expression:"activePlayer"}},[s("el-tab-pane",{attrs:{label:"Jessibuca",name:"jessibuca"}},["jessibuca"===e.activePlayer?s("jessibucaPlayer",{ref:"jessibuca",attrs:{visible:e.showVideoDialog,"video-url":e.videoUrl,error:e.videoError,message:e.videoError,"has-audio":e.hasAudio,fluent:"",autoplay:"",live:""},on:{"update:visible":function(t){e.showVideoDialog=t}}}):e._e()],1),s("el-tab-pane",{attrs:{label:"WebRTC",name:"webRTC"}},["webRTC"===e.activePlayer?s("rtc-player",{ref:"webRTC",attrs:{visible:e.showVideoDialog,"video-url":e.videoUrl,error:e.videoError,message:e.videoError,height:"100px","has-audio":e.hasAudio,fluent:"",autoplay:"",live:""},on:{"update:visible":function(t){e.showVideoDialog=t}}}):e._e()],1),s("el-tab-pane",{attrs:{label:"h265web",name:"h265web"}},["h265web"===e.activePlayer?s("h265web",{ref:"h265web",attrs:{"video-url":e.videoUrl,error:e.videoError,message:e.videoError,"has-audio":e.hasAudio,fluent:"",autoplay:"",live:"","show-button":!0}}):e._e()],1)],1):e._e(),1==Object.keys(this.player).length&&this.player.jessibuca?s("jessibucaPlayer",{ref:"jessibuca",attrs:{visible:e.showVideoDialog,"video-url":e.videoUrl,error:e.videoError,message:e.videoError,"has-audio":e.hasAudio,fluent:"",autoplay:"",live:""},on:{"update:visible":function(t){e.showVideoDialog=t}}}):e._e(),1==Object.keys(this.player).length&&this.player.webRTC?s("rtc-player",{ref:"jessibuca",attrs:{visible:e.showVideoDialog,"video-url":e.videoUrl,error:e.videoError,message:e.videoError,height:"100px","has-audio":e.hasAudio,fluent:"",autoplay:"",live:""},on:{"update:visible":function(t){e.showVideoDialog=t}}}):e._e(),1==Object.keys(this.player).length&&this.player.h265web?s("h265web",{ref:"jessibuca",attrs:{visible:e.showVideoDialog,"video-url":e.videoUrl,error:e.videoError,message:e.videoError,height:"100px","has-audio":e.hasAudio,fluent:"",autoplay:"",live:""},on:{"update:visible":function(t){e.showVideoDialog=t}}}):e._e()],1),s("div",{staticStyle:{"text-align":"right","margin-top":"1rem"},attrs:{id:"shared"}},[s("el-tabs",{on:{"tab-click":e.tabHandleClick},model:{value:e.tabActiveName,callback:function(t){e.tabActiveName=t},expression:"tabActiveName"}},[s("el-tab-pane",{attrs:{label:"实时视频",name:"media"}},[s("div",{staticStyle:{display:"flex","margin-bottom":"0.5rem",height:"2.5rem"}},[s("span",{staticStyle:{width:"5rem","line-height":"2.5rem","text-align":"right"}},[e._v("播放地址：")]),s("el-input",{attrs:{disabled:!0},model:{value:e.getPlayerShared.sharedUrl,callback:function(t){e.$set(e.getPlayerShared,"sharedUrl",t)},expression:"getPlayerShared.sharedUrl"}},[s("template",{slot:"append"},[s("i",{staticClass:"cpoy-btn el-icon-document-copy",staticStyle:{cursor:"pointer"},attrs:{title:"点击拷贝"},on:{click:function(t){return e.copyUrl(e.getPlayerShared.sharedUrl)}}})])],2)],1),s("div",{staticStyle:{display:"flex","margin-bottom":"0.5rem",height:"2.5rem"}},[s("span",{staticStyle:{width:"5rem","line-height":"2.5rem","text-align":"right"}},[e._v("iframe：")]),s("el-input",{attrs:{disabled:!0},model:{value:e.getPlayerShared.sharedIframe,callback:function(t){e.$set(e.getPlayerShared,"sharedIframe",t)},expression:"getPlayerShared.sharedIframe"}},[s("template",{slot:"append"},[s("i",{staticClass:"cpoy-btn el-icon-document-copy",staticStyle:{cursor:"pointer"},attrs:{title:"点击拷贝"},on:{click:function(t){return e.copyUrl(e.getPlayerShared.sharedIframe)}}})])],2)],1),s("div",{staticStyle:{display:"flex","margin-bottom":"0.5rem",height:"2.5rem"}},[s("span",{staticStyle:{width:"5rem","line-height":"2.5rem","text-align":"right"}},[e._v("资源地址：")]),s("el-input",{attrs:{disabled:!0},model:{value:e.getPlayerShared.sharedRtmp,callback:function(t){e.$set(e.getPlayerShared,"sharedRtmp",t)},expression:"getPlayerShared.sharedRtmp"}},[s("el-button",{staticStyle:{cursor:"pointer"},attrs:{slot:"append",icon:"el-icon-document-copy",title:"点击拷贝"},on:{click:function(t){return e.copyUrl(e.getPlayerShared.sharedIframe)}},slot:"append"}),e.streamInfo?s("el-dropdown",{attrs:{slot:"prepend",trigger:"click"},on:{command:e.copyUrl},slot:"prepend"},[s("el-button",[e._v(" 更多地址"),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),s("el-dropdown-menu",[e.streamInfo.flv?s("el-dropdown-item",{attrs:{command:e.streamInfo.flv}},[s("el-tag",[e._v("FLV:")]),s("span",[e._v(e._s(e.streamInfo.flv))])],1):e._e(),e.streamInfo.https_flv?s("el-dropdown-item",{attrs:{command:e.streamInfo.https_flv}},[s("el-tag",[e._v("FLV(https):")]),s("span",[e._v(e._s(e.streamInfo.https_flv))])],1):e._e(),e.streamInfo.ws_flv?s("el-dropdown-item",{attrs:{command:e.streamInfo.ws_flv}},[s("el-tag",[e._v("FLV(ws):")]),s("span",[e._v(e._s(e.streamInfo.ws_flv))])],1):e._e(),e.streamInfo.wss_flv?s("el-dropdown-item",{attrs:{command:e.streamInfo.wss_flv}},[s("el-tag",[e._v("FLV(wss):")]),s("span",[e._v(e._s(e.streamInfo.wss_flv))])],1):e._e(),e.streamInfo.fmp4?s("el-dropdown-item",{attrs:{command:e.streamInfo.fmp4}},[s("el-tag",[e._v("FMP4:")]),s("span",[e._v(e._s(e.streamInfo.fmp4))])],1):e._e(),e.streamInfo.https_fmp4?s("el-dropdown-item",{attrs:{command:e.streamInfo.https_fmp4}},[s("el-tag",[e._v("FMP4(https):")]),s("span",[e._v(e._s(e.streamInfo.https_fmp4))])],1):e._e(),e.streamInfo.ws_fmp4?s("el-dropdown-item",{attrs:{command:e.streamInfo.ws_fmp4}},[s("el-tag",[e._v("FMP4(ws):")]),s("span",[e._v(e._s(e.streamInfo.ws_fmp4))])],1):e._e(),e.streamInfo.wss_fmp4?s("el-dropdown-item",{attrs:{command:e.streamInfo.wss_fmp4}},[s("el-tag",[e._v("FMP4(wss):")]),s("span",[e._v(e._s(e.streamInfo.wss_fmp4))])],1):e._e(),e.streamInfo.hls?s("el-dropdown-item",{attrs:{command:e.streamInfo.hls}},[s("el-tag",[e._v("HLS:")]),s("span",[e._v(e._s(e.streamInfo.hls))])],1):e._e(),e.streamInfo.https_hls?s("el-dropdown-item",{attrs:{command:e.streamInfo.https_hls}},[s("el-tag",[e._v("HLS(https):")]),s("span",[e._v(e._s(e.streamInfo.https_hls))])],1):e._e(),e.streamInfo.ws_hls?s("el-dropdown-item",{attrs:{command:e.streamInfo.ws_hls}},[s("el-tag",[e._v("HLS(ws):")]),s("span",[e._v(e._s(e.streamInfo.ws_hls))])],1):e._e(),e.streamInfo.wss_hls?s("el-dropdown-item",{attrs:{command:e.streamInfo.wss_hls}},[s("el-tag",[e._v("HLS(wss):")]),s("span",[e._v(e._s(e.streamInfo.wss_hls))])],1):e._e(),e.streamInfo.ts?s("el-dropdown-item",{attrs:{command:e.streamInfo.ts}},[s("el-tag",[e._v("TS:")]),s("span",[e._v(e._s(e.streamInfo.ts))])],1):e._e(),e.streamInfo.https_ts?s("el-dropdown-item",{attrs:{command:e.streamInfo.https_ts}},[s("el-tag",[e._v("TS(https):")]),s("span",[e._v(e._s(e.streamInfo.https_ts))])],1):e._e(),e.streamInfo.ws_ts?s("el-dropdown-item",{attrs:{command:e.streamInfo.ws_ts}},[s("el-tag",[e._v("TS(ws):")]),s("span",[e._v(e._s(e.streamInfo.ws_ts))])],1):e._e(),e.streamInfo.wss_ts?s("el-dropdown-item",{attrs:{command:e.streamInfo.wss_ts}},[s("el-tag",[e._v("TS(wss):")]),s("span",[e._v(e._s(e.streamInfo.wss_ts))])],1):e._e(),e.streamInfo.rtc?s("el-dropdown-item",{attrs:{command:e.streamInfo.rtc}},[s("el-tag",[e._v("RTC:")]),s("span",[e._v(e._s(e.streamInfo.rtc))])],1):e._e(),e.streamInfo.rtcs?s("el-dropdown-item",{attrs:{command:e.streamInfo.rtcs}},[s("el-tag",[e._v("RTCS:")]),s("span",[e._v(e._s(e.streamInfo.rtcs))])],1):e._e(),e.streamInfo.rtmp?s("el-dropdown-item",{attrs:{command:e.streamInfo.rtmp}},[s("el-tag",[e._v("RTMP:")]),s("span",[e._v(e._s(e.streamInfo.rtmp))])],1):e._e(),e.streamInfo.rtmps?s("el-dropdown-item",{attrs:{command:e.streamInfo.rtmps}},[s("el-tag",[e._v("RTMPS:")]),s("span",[e._v(e._s(e.streamInfo.rtmps))])],1):e._e(),e.streamInfo.rtsp?s("el-dropdown-item",{attrs:{command:e.streamInfo.rtsp}},[s("el-tag",[e._v("RTSP:")]),s("span",[e._v(e._s(e.streamInfo.rtsp))])],1):e._e(),e.streamInfo.rtsps?s("el-dropdown-item",{attrs:{command:e.streamInfo.rtsps}},[s("el-tag",[e._v("RTSPS:")]),s("span",[e._v(e._s(e.streamInfo.rtsps))])],1):e._e()],1)],1):e._e()],1)],1)]),e.showPtz?s("el-tab-pane",{attrs:{label:"云台控制",name:"control"}},[s("div",{staticStyle:{display:"grid","grid-template-columns":"240px auto",height:"180px",overflow:"auto"}},[s("div",{staticStyle:{display:"grid","grid-template-columns":"6.25rem auto"}},[s("div",{staticClass:"control-wrapper"},[s("div",{staticClass:"control-btn control-top",on:{mousedown:function(t){return e.ptzCamera("up")},mouseup:function(t){return e.ptzCamera("stop")}}},[s("i",{staticClass:"el-icon-caret-top"}),s("div",{staticClass:"control-inner-btn control-inner"})]),s("div",{staticClass:"control-btn control-left",on:{mousedown:function(t){return e.ptzCamera("left")},mouseup:function(t){return e.ptzCamera("stop")}}},[s("i",{staticClass:"el-icon-caret-left"}),s("div",{staticClass:"control-inner-btn control-inner"})]),s("div",{staticClass:"control-btn control-bottom",on:{mousedown:function(t){return e.ptzCamera("down")},mouseup:function(t){return e.ptzCamera("stop")}}},[s("i",{staticClass:"el-icon-caret-bottom"}),s("div",{staticClass:"control-inner-btn control-inner"})]),s("div",{staticClass:"control-btn control-right",on:{mousedown:function(t){return e.ptzCamera("right")},mouseup:function(t){return e.ptzCamera("stop")}}},[s("i",{staticClass:"el-icon-caret-right"}),s("div",{staticClass:"control-inner-btn control-inner"})]),s("div",{staticClass:"control-round"},[s("div",{staticClass:"control-round-inner"},[s("i",{staticClass:"fa fa-pause-circle"})])]),s("div",{staticClass:"contro-speed",staticStyle:{position:"absolute",left:"4px",top:"7rem",width:"6.25rem"}},[s("el-slider",{attrs:{max:100},model:{value:e.controSpeed,callback:function(t){e.controSpeed=t},expression:"controSpeed"}})],1)]),s("div",[s("div",{staticClass:"ptz-btn-box"},[s("div",{attrs:{title:"变倍+"},on:{mousedown:function(t){return e.ptzCamera("zoomin")},mouseup:function(t){return e.ptzCamera("stop")}}},[s("i",{staticClass:"el-icon-zoom-in control-zoom-btn",staticStyle:{"font-size":"1.5rem"}})]),s("div",{attrs:{title:"变倍-"},on:{mousedown:function(t){return e.ptzCamera("zoomout")},mouseup:function(t){return e.ptzCamera("stop")}}},[s("i",{staticClass:"el-icon-zoom-out control-zoom-btn",staticStyle:{"font-size":"1.5rem"}})])]),s("div",{staticClass:"ptz-btn-box"},[s("div",{attrs:{title:"聚焦+"},on:{mousedown:function(t){return e.focusCamera("near")},mouseup:function(t){return e.focusCamera("stop")}}},[s("i",{staticClass:"iconfont icon-bianjiao-fangda control-zoom-btn",staticStyle:{"font-size":"1.5rem"}})]),s("div",{attrs:{title:"聚焦-"},on:{mousedown:function(t){return e.focusCamera("far")},mouseup:function(t){return e.focusCamera("stop")}}},[s("i",{staticClass:"iconfont icon-bianjiao-suoxiao control-zoom-btn",staticStyle:{"font-size":"1.5rem"}})])]),s("div",{staticClass:"ptz-btn-box"},[s("div",{attrs:{title:"光圈+"},on:{mousedown:function(t){return e.irisCamera("in")},mouseup:function(t){return e.irisCamera("stop")}}},[s("i",{staticClass:"iconfont icon-guangquan control-zoom-btn",staticStyle:{"font-size":"1.5rem"}})]),s("div",{attrs:{title:"光圈-"},on:{mousedown:function(t){return e.irisCamera("out")},mouseup:function(t){return e.irisCamera("stop")}}},[s("i",{staticClass:"iconfont icon-guangquan- control-zoom-btn",staticStyle:{"font-size":"1.5rem"}})])])])]),"control"===e.tabActiveName?s("div",{staticStyle:{"text-align":"left"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini",placeholder:"请选择云台功能"},model:{value:e.ptzMethod,callback:function(t){e.ptzMethod=t},expression:"ptzMethod"}},[s("el-option",{attrs:{label:"预置点",value:"preset"}}),s("el-option",{attrs:{label:"巡航组",value:"cruise"}}),s("el-option",{attrs:{label:"自动扫描",value:"scan"}}),s("el-option",{attrs:{label:"雨刷",value:"wiper"}}),s("el-option",{attrs:{label:"辅助开关",value:"switch"}})],1),"preset"===e.ptzMethod?s("ptzPreset",{staticStyle:{"margin-top":"1rem"},attrs:{"channel-id":e.channelId}}):e._e(),"cruise"===e.ptzMethod?s("ptzCruising",{staticStyle:{"margin-top":"1rem"},attrs:{"channel-id":e.channelId}}):e._e(),"scan"===e.ptzMethod?s("ptzScan",{staticStyle:{"margin-top":"1rem"},attrs:{"channel-id":e.channelId}}):e._e(),"wiper"===e.ptzMethod?s("ptzWiper",{staticStyle:{"margin-top":"1rem"},attrs:{"channel-id":e.channelId}}):e._e(),"switch"===e.ptzMethod?s("ptzSwitch",{staticStyle:{"margin-top":"1rem"},attrs:{"channel-id":e.channelId}}):e._e()],1):e._e()])]):e._e(),s("el-tab-pane",{attrs:{label:"编码信息",name:"codec"}},[s("mediaInfo",{ref:"mediaInfo",attrs:{app:e.app,stream:e.streamId,"media-server-id":e.mediaServerId}})],1),e.showBroadcast?s("el-tab-pane",{attrs:{label:"语音对讲",name:"broadcast"}},[s("div",{staticStyle:{padding:"0 10px"}},[s("el-radio-group",{attrs:{disabled:-1!==e.broadcastStatus},model:{value:e.broadcastMode,callback:function(t){e.broadcastMode=t},expression:"broadcastMode"}},[s("el-radio",{attrs:{label:!0}},[e._v("喊话(Broadcast)")]),s("el-radio",{attrs:{label:!1}},[e._v("对讲(Talk)")])],1)],1),s("div",{staticClass:"trank",staticStyle:{"text-align":"center"}},[s("el-button",{staticStyle:{"font-size":"32px",padding:"24px","margin-top":"24px"},attrs:{type:e.getBroadcastStatus(),disabled:-2===e.broadcastStatus,circle:"",icon:"el-icon-microphone"},on:{click:function(t){return e.broadcastStatusClick()}}}),s("p",[-2===e.broadcastStatus?s("span",[e._v("正在释放资源")]):e._e(),-1===e.broadcastStatus?s("span",[e._v("点击开始对讲")]):e._e(),0===e.broadcastStatus?s("span",[e._v("等待接通中...")]):e._e(),1===e.broadcastStatus?s("span",[e._v("请说话")]):e._e()])],1)]):e._e()],1)],1)]):e._e()],1)}),i=[],r=(s("caad"),s("e9c4"),s("b64b"),s("2532"),s("a888")),l=s("1c46"),c=s.n(l),d=s("bbf2"),u=s("2655"),m=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{width:"100%"},attrs:{id:"ptzPreset"}},[e._l(e.presetList,(function(t){return s("el-tag",{key:t.presetId,staticStyle:{"margin-right":"1rem",cursor:"pointer","margin-bottom":"0.6rem"},attrs:{closable:"",size:"mini"},on:{close:function(s){return e.delPreset(t)},click:function(s){return e.gotoPreset(t)}}},[e._v(" "+e._s(t.presetName?t.presetName:t.presetId)+" ")])})),e.inputVisible?s("el-input",{ref:"saveTagInput",staticStyle:{width:"300px","vertical-align":"bottom"},attrs:{min:"1",max:"255",placeholder:"预置位编号","addon-before":"预置位编号","addon-after":"(1-255)",size:"small"},scopedSlots:e._u([{key:"append",fn:function(){return[s("el-button",{on:{click:function(t){return e.addPreset()}}},[e._v("保存")]),s("el-button",{on:{click:function(t){return e.cancel()}}},[e._v("取消")])]},proxy:!0}],null,!1,3889715118),model:{value:e.ptzPresetId,callback:function(t){e.ptzPresetId=t},expression:"ptzPresetId"}}):s("el-button",{attrs:{size:"small"},on:{click:e.showInput}},[e._v("+ 添加")])],2)},p=[],h={name:"PtzPreset",components:{},props:["channelId"],data:function(){return{presetList:[],inputVisible:!1,ptzPresetId:""}},created:function(){this.getPresetList()},methods:{getPresetList:function(){var e=this;this.$store.dispatch("commonChanel/queryPreset",this.channelId).then((function(t){e.presetList=t,e.$nextTick((function(){e.$refs.channelListTable.doLayout()}))}))},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},addPreset:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("commonChanel/addPreset",{channelId:this.channelId,presetId:this.ptzPresetId,presetName:this.ptzPresetId}).then((function(t){setTimeout((function(){e.inputVisible=!1,e.ptzPresetId="",e.getPresetList()}),1e3)})).catch((function(s){t.close(),e.inputVisible=!1,e.ptzPresetId="",e.$message({showClose:!0,message:s,type:"error"})})).finally((function(){t.close()}))},cancel:function(){this.inputVisible=!1,this.ptzPresetId=""},gotoPreset:function(e){var t=this;console.log(e),this.$store.dispatch("commonChanel/callPreset",{channelId:this.channelId,presetId:e.presetId}).then((function(e){t.$message({showClose:!0,message:"调用成功",type:"success"})})).catch((function(e){t.$message({showClose:!0,message:e,type:"error"})}))},delPreset:function(e){var t=this;this.$confirm("确定删除此预置位","提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var s=t.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});t.$store.dispatch("commonChanel/deletePreset",{channelId:t.channelId,presetId:e.presetId}).then((function(e){setTimeout((function(){t.getPresetList()}),1e3)})).catch((function(e){t.$message({showClose:!0,message:e,type:"error"})})).finally((function(){s.close()}))})).catch((function(){}))}}},f=h,b=s("2877"),g=Object(b["a"])(f,m,p,!1,null,null,null),v=g.exports,y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"ptzCruising"}},[s("div",{staticStyle:{display:"grid","grid-template-columns":"80px auto","line-height":"28px"}},[s("span",[e._v("巡航组号: ")]),s("el-input",{attrs:{min:"1",max:"255",placeholder:"巡航组号","addon-before":"巡航组号","addon-after":"(1-255)",size:"mini"},model:{value:e.tourId,callback:function(t){e.tourId=t},expression:"tourId"}})],1),s("p",e._l(e.presetList,(function(t,a){return s("el-tag",{key:t.presetId,staticStyle:{"margin-right":"1rem",cursor:"pointer"},attrs:{closable:""},on:{close:function(s){return e.delPreset(t,a)}}},[e._v(" "+e._s(t.presetName?t.presetName:t.presetId)+" ")])})),1),e.selectPresetVisible?s("el-form",{attrs:{size:"mini",inline:!0}},[s("el-form-item",[s("el-select",{attrs:{placeholder:"请选择预置点"},model:{value:e.selectPreset,callback:function(t){e.selectPreset=t},expression:"selectPreset"}},e._l(e.allPresetList,(function(e){return s("el-option",{key:e.presetId,attrs:{label:e.presetName,value:e}})})),1)],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.addCruisePoint}},[e._v("保存")]),s("el-button",{attrs:{type:"primary"},on:{click:e.cancelAddCruisePoint}},[e._v("取消")])],1)],1):s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.selectPresetVisible=!0}}},[e._v("添加巡航点")]),e.setSpeedVisible?s("el-form",{attrs:{size:"mini",inline:!0}},[s("el-form-item",[e.setSpeedVisible?s("el-input",{attrs:{min:"1",max:"4095",placeholder:"巡航速度","addon-before":"巡航速度","addon-after":"(1-4095)",size:"mini"},model:{value:e.cruiseSpeed,callback:function(t){e.cruiseSpeed=t},expression:"cruiseSpeed"}}):e._e()],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.setCruiseSpeed}},[e._v("保存")]),s("el-button",{on:{click:e.cancelSetCruiseSpeed}},[e._v("取消")])],1)],1):s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.setSpeedVisible=!0}}},[e._v("设置巡航速度")]),e.setTimeVisible?s("el-form",{attrs:{size:"mini",inline:!0}},[s("el-form-item",[s("el-input",{staticStyle:{width:"100%"},attrs:{min:"1",max:"4095",placeholder:"巡航停留时间(秒)","addon-before":"巡航停留时间(秒)","addon-after":"(1-4095)"},model:{value:e.cruiseTime,callback:function(t){e.cruiseTime=t},expression:"cruiseTime"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.setCruiseTime}},[e._v("保存")]),s("el-button",{on:{click:e.cancelSetCruiseTime}},[e._v("取消")])],1)],1):s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.setTimeVisible=!0}}},[e._v("设置巡航时间")]),s("el-button",{attrs:{size:"mini"},on:{click:e.startCruise}},[e._v("开始巡航")]),s("el-button",{attrs:{size:"mini"},on:{click:e.stopCruise}},[e._v("停止巡航")]),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:e.deleteCruise}},[e._v("删除巡航")])],1)},S=[],w=(s("a434"),{name:"PtzCruising",components:{},props:["channelId"],data:function(){return{tourId:1,presetList:[],allPresetList:[],selectPreset:"",inputVisible:!1,selectPresetVisible:!1,setSpeedVisible:!1,setTimeVisible:!1,cruiseSpeed:"",cruiseTime:""}},created:function(){this.getPresetList()},methods:{getPresetList:function(){var e=this;this.$store.dispatch("commonChanel/queryPreset",this.channelId).then((function(t){e.allPresetList=t}))},addCruisePoint:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("commonChanel/addPointForCruise",{channelId:this.channelId,tourId:this.tourId,presetId:this.selectPreset.presetId}).then((function(t){e.presetList.push(e.selectPreset)})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.selectPreset="",e.selectPresetVisible=!1,t.close()}))},cancelAddCruisePoint:function(){this.selectPreset="",this.selectPresetVisible=!1},delPreset:function(e,t){var s=this,a=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("commonChanel/deletePointForCruise",{channelId:this.channelId,tourId:this.tourId,presetId:e.presetId}).then((function(e){s.presetList.splice(t,1)})).catch((function(e){s.$message({showClose:!0,message:e,type:"error"})})).finally((function(){a.close()}))},deleteCruise:function(e,t){var s=this;this.$confirm("确定删除此巡航组","提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=s.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});s.$store.dispatch("commonChanel/deletePointForCruise",{channelId:s.channelId,tourId:s.tourId,presetId:0}).then((function(e){s.presetList=[]})).catch((function(e){s.$message({showClose:!0,message:e,type:"error"})})).finally((function(){e.close()}))}))},setCruiseSpeed:function(){var e=this;if(0!==this.presetList.length){var t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("commonChanel/setCruiseSpeed",{channelId:this.channelId,tourId:this.tourId,presetId:this.presetList.at(-1).presetId,speed:this.cruiseSpeed}).then((function(t){e.$message({showClose:!0,message:"保存成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.cruiseSpeed="",e.setSpeedVisible=!1,t.close()}))}else this.$message({showClose:!0,message:"请添加巡航点",type:"warning"})},cancelSetCruiseSpeed:function(){this.cruiseSpeed="",this.setSpeedVisible=!1},setCruiseTime:function(){var e=this;if(0!==this.presetList.length){var t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("commonChanel/setCruiseTime",{channelId:this.channelId,tourId:this.tourId,time:this.cruiseTime,presetId:this.presetList.at(-1).presetId}).then((function(t){e.$message({showClose:!0,message:"保存成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.setTimeVisible=!1,e.cruiseTime="",t.close()}))}else this.$message({showClose:!0,message:"请添加巡航点",type:"warning"})},cancelSetCruiseTime:function(){this.setTimeVisible=!1,this.cruiseTime=""},startCruise:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("commonChanel/startCruise",{channelId:this.channelId,tourId:this.tourId}).then((function(t){e.$message({showClose:!0,message:"发送成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.setTimeVisible=!1,e.cruiseTime="",t.close()}))},stopCruise:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("commonChanel/stopCruise",{channelId:this.channelId,tourId:this.tourId}).then((function(t){e.$message({showClose:!0,message:"发送成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.setTimeVisible=!1,e.cruiseTime="",t.close()}))}}}),I=w,C=Object(b["a"])(I,y,S,!1,null,null,null),_=C.exports,k=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"ptzScan"}},[s("div",{staticStyle:{display:"grid","grid-template-columns":"80px auto","line-height":"28px"}},[s("span",[e._v("扫描组号: ")]),s("el-input",{attrs:{min:"1",max:"255",placeholder:"扫描组号","addon-before":"扫描组号","addon-after":"(1-255)",size:"mini"},model:{value:e.scanId,callback:function(t){e.scanId=t},expression:"scanId"}})],1),s("el-button",{attrs:{size:"mini"},on:{click:e.setScanLeft}},[e._v("设置左边界")]),s("el-button",{attrs:{size:"mini"},on:{click:e.setScanRight}},[e._v("设置右边界")]),e.setSpeedVisible?s("el-form",{attrs:{size:"mini",inline:!0}},[s("el-form-item",[e.setSpeedVisible?s("el-input",{attrs:{min:"1",max:"4095",placeholder:"巡航速度","addon-before":"巡航速度","addon-after":"(1-4095)",size:"mini"},model:{value:e.speed,callback:function(t){e.speed=t},expression:"speed"}}):e._e()],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.setSpeed}},[e._v("保存")]),s("el-button",{on:{click:e.cancelSetSpeed}},[e._v("取消")])],1)],1):s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.setSpeedVisible=!0}}},[e._v("设置扫描速度")]),s("el-button",{attrs:{size:"mini"},on:{click:e.startScan}},[e._v("开始自动扫描")]),s("el-button",{attrs:{size:"mini"},on:{click:e.stopScan}},[e._v("停止自动扫描")])],1)},x=[],$={name:"PtzScan",components:{},props:["channelId"],data:function(){return{scanId:1,setSpeedVisible:!1,speed:""}},created:function(){},methods:{setSpeed:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("commonChanel/setSpeedForScan",{channelId:this.channelId,scanId:this.scanId,speed:this.speed}).then((function(t){e.$message({showClose:!0,message:"保存成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.speed="",e.setSpeedVisible=!1,t.close()}))},cancelSetSpeed:function(){this.speed="",this.setSpeedVisible=!1},setScanLeft:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("commonChanel/setLeftForScan",{channelId:this.channelId,scanId:this.scanId}).then((function(t){e.$message({showClose:!0,message:"保存成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.speed="",e.setSpeedVisible=!1,t.close()}))},setScanRight:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("commonChanel/setRightForScan",{channelId:this.channelId,scanId:this.scanId}).then((function(t){e.$message({showClose:!0,message:"保存成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.speed="",e.setSpeedVisible=!1,t.close()}))},startScan:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("commonChanel/startScan",{channelId:this.channelId,scanId:this.scanId}).then((function(t){e.$message({showClose:!0,message:"发送成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){t.close()}))},stopScan:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("commonChanel/stopScan",{channelId:this.channelId,scanId:this.scanId}).then((function(t){e.$message({showClose:!0,message:"发送成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){t.close()}))}}},P=$,T=(s("8754"),Object(b["a"])(P,k,x,!1,null,null,null)),z=T.exports,L=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"ptzWiper"}},[s("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.open("on")}}},[e._v("开启")]),s("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.open("off")}}},[e._v("关闭")])],1)},D=[],E={name:"PtzWiper",components:{},props:["channelId"],data:function(){return{}},created:function(){},methods:{open:function(e){var t=this,s=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("commonChanel/wiper",{channelId:this.channelId,command:e}).then((function(e){t.$message({showClose:!0,message:"保存成功",type:"success"})})).catch((function(e){t.$message({showClose:!0,message:e,type:"error"})})).finally((function(){s.close()}))}}},R=E,N=(s("c522"),Object(b["a"])(R,L,D,!1,null,null,null)),V=N.exports,M=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"ptzScan"}},[s("el-form",{attrs:{size:"mini",inline:!0}},[s("el-form-item",[s("el-input",{attrs:{min:"1",max:"4095",placeholder:"开关编号","addon-before":"开关编号","addon-after":"(2-255)",size:"mini"},model:{value:e.auxiliaryId,callback:function(t){e.auxiliaryId=t},expression:"auxiliaryId"}})],1),s("el-form-item",[s("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.open("on")}}},[e._v("开启")]),s("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.open("off")}}},[e._v("关闭")])],1)],1)],1)},A=[],U={name:"PtzScan",components:{},props:["channelId"],data:function(){return{auxiliaryId:1}},created:function(){},methods:{open:function(e){var t=this,s=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("commonChanel/auxiliary",{channelId:this.channelId,command:e,auxiliaryId:this.auxiliaryId}).then((function(e){t.$message({showClose:!0,message:"保存成功",type:"success"})})).catch((function(e){t.$message({showClose:!0,message:e,type:"error"})})).finally((function(){s.close()}))}}},F=U,O=Object(b["a"])(F,M,A,!1,null,null,null),j=O.exports,B=s("3031"),G=s("4f91"),W={name:"DevicePlayer",directives:{elDragDialog:r["a"]},components:{H265web:G["a"],PtzPreset:v,PtzCruising:_,ptzScan:z,ptzWiper:V,ptzSwitch:j,mediaInfo:B["a"],jessibucaPlayer:u["default"],rtcPlayer:d["default"]},props:{},data:function(){return{video:"http://lndxyj.iqilu.com/public/upload/2019/10/14/8c001ea0c09cdc59a57829dabc8010fa.mp4",videoUrl:"",activePlayer:"jessibuca",player:{jessibuca:["ws_flv","wss_flv"],webRTC:["rtc","rtcs"],h265web:["ws_flv","wss_flv"]},showVideoDialog:!1,channelId:null,streamId:"",ptzMethod:"preset",ptzPresetId:"",app:"",mediaServerId:"",tabActiveName:"media",hasAudio:!1,loadingRecords:!1,recordsLoading:!1,isLoging:!1,controSpeed:30,timeVal:0,timeMin:0,timeMax:1440,presetPos:1,cruisingSpeed:100,cruisingTime:5,cruisingGroup:0,scanSpeed:100,scanGroup:0,tracks:[],showPtz:!0,showBroadcast:!0,showRrecord:!0,sliderTime:0,seekTime:0,recordStartTime:0,showTimeText:"00:00:00",streamInfo:null,broadcastMode:!0,broadcastRtc:null,broadcastStatus:-1}},computed:{getPlayerShared:function(){return{sharedUrl:window.location.origin+"/#/play/wasm/"+encodeURIComponent(this.videoUrl),sharedIframe:window.location.origin+'<iframe src="/public#/play/wasm/"></iframe>'+encodeURIComponent(this.videoUrl),sharedRtmp:this.videoUrl}}},created:function(){this.broadcastStatus=-1,1===Object.keys(this.player).length&&(this.activePlayer=Object.keys(this.player)[0])},methods:{tabHandleClick:function(e,t){console.log(e),this.tracks=[],"codec"===e.name?this.$refs.mediaInfo.startTask():this.$refs.mediaInfo.stopTask()},changePlayer:function(e){console.log(this.player[e.name][0]),this.activePlayer=e.name,this.videoUrl=this.getUrlByStreamInfo(),console.log(this.videoUrl)},openDialog:function(e,t,s){if(!this.showVideoDialog)switch(this.tabActiveName=e,this.channelId=t,this.streamId="",this.mediaServerId="",this.app="",this.videoUrl="",this.$refs[this.activePlayer]&&this.$refs[this.activePlayer].pause(),e){case"media":this.play(s.streamInfo,s.hasAudio);break;case"streamPlay":this.tabActiveName="media",this.showRrecord=!1,this.showPtz=!1,this.showBroadcast=!1,this.play(s.streamInfo,s.hasAudio);break;case"control":break}},play:function(e,t){this.streamInfo=e,this.hasAudio=t,this.isLoging=!1,this.videoUrl=this.getUrlByStreamInfo(),this.streamId=e.stream,this.app=e.app,this.mediaServerId=e.mediaServerId,this.playFromStreamInfo(!1,e)},getUrlByStreamInfo:function(){console.log(this.streamInfo);var e=this.streamInfo;return this.streamInfo.transcodeStream&&(e=this.streamInfo.transcodeStream),"https:"===location.protocol?this.videoUrl=e[this.player[this.activePlayer][1]]:this.videoUrl=e[this.player[this.activePlayer][0]],this.videoUrl},playFromStreamInfo:function(e,t){var s=this;this.showVideoDialog=!0,this.hasaudio=e&&this.hasaudio,this.$refs[this.activePlayer]?this.$refs[this.activePlayer].play(this.getUrlByStreamInfo(t)):this.$nextTick((function(){s.$refs[s.activePlayer].play(s.getUrlByStreamInfo(t))}))},close:function(){console.log("关闭视频"),this.$refs[this.activePlayer]&&this.$refs[this.activePlayer].pause(),this.videoUrl="",this.showVideoDialog=!1,this.stopBroadcast()},ptzCamera:function(e){console.log("云台控制："+e),this.$store.dispatch("commonChanel/ptz",{channelId:this.channelId,command:e,panSpeed:this.controSpeed,tiltSpeed:this.controSpeed,zoomSpeed:this.controSpeed})},irisCamera:function(e){this.$store.dispatch("commonChanel/iris",{channelId:this.channelId,command:e,speed:this.controSpeed})},focusCamera:function(e){this.$store.dispatch("commonChanel/focus",{channelId:this.channelId,command:e,speed:this.controSpeed})},videoError:function(e){console.log("播放器错误："+JSON.stringify(e))},copyUrl:function(e){var t=this;console.log(e),this.$copyText(e).then((function(e){t.$message.success({showClose:!0,message:"成功拷贝到粘贴板"})}),(function(e){}))},getBroadcastStatus:function(){return-2==this.broadcastStatus||-1==this.broadcastStatus?"primary":0==this.broadcastStatus?"warning":1===this.broadcastStatus?"danger":void 0},broadcastStatusClick:function(){var e=this;-1===this.broadcastStatus?(this.broadcastStatus=0,this.$store.dispatch("play/broadcastStart",[this.channelId,this.broadcastMode]).then((function(t){var s=t.streamInfo;document.location.protocol.includes("https")?e.startBroadcast(s.rtcs):e.startBroadcast(s.rtc)}))):1===this.broadcastStatus&&(this.broadcastStatus=-1,this.broadcastRtc.close())},startBroadcast:function(e){var t=this;this.$store.dispatch("user/getUserInfo").then((function(s){if(null!=s){var a=s.pushKey;e+="&sign="+c.a.createHash("md5").update(a,"utf8").digest("hex"),console.log("开始语音喊话： "+e),t.broadcastRtc=new ZLMRTCClient.Endpoint({debug:!0,zlmsdpUrl:e,simulecast:!1,useCamera:!1,audioEnable:!0,videoEnable:!1,recvOnly:!1}),t.broadcastRtc.on(ZLMRTCClient.Events.WEBRTC_NOT_SUPPORT,(function(e){console.error("不支持webrtc",e),t.$message({showClose:!0,message:"不支持webrtc, 无法进行语音喊话",type:"error"}),t.broadcastStatus=-1})),t.broadcastRtc.on(ZLMRTCClient.Events.WEBRTC_ICE_CANDIDATE_ERROR,(function(e){console.error("ICE 协商出错"),t.$message({showClose:!0,message:"ICE 协商出错",type:"error"}),t.broadcastStatus=-1})),t.broadcastRtc.on(ZLMRTCClient.Events.WEBRTC_OFFER_ANWSER_EXCHANGE_FAILED,(function(e){console.error("offer anwser 交换失败",e),t.$message({showClose:!0,message:"offer anwser 交换失败"+e,type:"error"}),t.broadcastStatus=-1})),t.broadcastRtc.on(ZLMRTCClient.Events.WEBRTC_ON_CONNECTION_STATE_CHANGE,(function(e){console.log("状态改变",e),"connecting"===e?t.broadcastStatus=0:"connected"===e?t.broadcastStatus=1:"disconnected"===e&&(t.broadcastStatus=-1)})),t.broadcastRtc.on(ZLMRTCClient.Events.CAPTURE_STREAM_FAILED,(function(e){console.log("捕获流失败",e),t.$message({showClose:!0,message:"捕获流失败"+e,type:"error"}),t.broadcastStatus=-1}))}else t.broadcastStatus=-1})).catch((function(e){t.$message({showClose:!0,message:e,type:"error"}),t.broadcastStatus=-1}))},stopBroadcast:function(){this.broadcastRtc.close(),this.broadcastStatus=-1,this.$store.dispatch("play/broadcastStop",[this.channelId])}}},H=W,q=(s("e4f7"),Object(b["a"])(H,n,i,!1,null,null,null)),J=q.exports,Z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.locading,expression:"locading"}],staticStyle:{width:"100%"},attrs:{id:"ChannelEdit"}},[s("div",{staticClass:"page-header"},[s("div",{staticClass:"page-title"},[s("el-page-header",{attrs:{content:"编辑通道"},on:{back:e.close}})],1)]),s("CommonChannelEdit",{ref:"commonChannelEdit",attrs:{id:e.id,"save-success":e.close,cancel:e.close}})],1)},K=[],X=s("7317"),Q={name:"ChannelEdit",components:{CommonChannelEdit:X["a"]},props:["id","closeEdit"],data:function(){return{}},methods:{close:function(){this.closeEdit()}}},Y=Q,ee=Object(b["a"])(Y,Z,K,!1,null,null,null),te=ee.exports,se={name:"ChannelList",components:{devicePlayer:J,ChannelEdit:te},props:{defaultPage:{type:Number,default:1},defaultCount:{type:Number,default:15}},computed:{excelName:function(){return"通道列表-"+this.currentPage}},data:function(){var e=this;return{device:null,channelList:[],excelFields:{"名称":"gbName","编号":"gbDeviceId","厂家":"gbManufacturer","类型":{field:"dataType",callback:function(t){return e.$channelTypeList[t].name}},"经度":"gbLongitude","纬度":"gbLatitude","云台类型":"ptzTypeText","状态":{field:"gbStatus",callback:function(e){return"ON"===e?"在线":"离线"}}},videoComponentList:[],currentPlayerInfo:{},updateLooper:0,searchStr:"",channelType:"",online:"true",subStream:"",winHeight:window.innerHeight-200,currentPage:1|this.defaultPage,count:15|this.defaultCount,total:0,beforeUrl:"/device",editId:null}},mounted:function(){this.initData()},destroyed:function(){this.$destroy("videojs"),clearTimeout(this.updateLooper)},methods:{initData:function(){this.getChannelList()},initParam:function(){this.currentPage=1,this.count=15},currentChange:function(e){this.currentPage=e,this.initData()},handleSizeChange:function(e){this.count=e,this.getChannelList()},getChannelList:function(){var e=this;this.$store.dispatch("commonChanel/getList",{page:this.currentPage,count:this.count,query:this.searchStr,online:this.online,channelType:this.channelType}).then((function(t){e.total=t.total,e.channelList=t.list,e.channelList.forEach((function(t){t.ptzType=t.ptzType+"",e.$set(t,"playLoading",!1)})),e.$nextTick((function(){e.$refs.channelListTable.doLayout()}))}))},sendDevicePush:function(e){var t=this;e.playLoading=!0,this.$store.dispatch("commonChanel/playChannel",e.gbId).then((function(s){e.streamId=s.stream,t.$refs.devicePlayer.openDialog("media",e.gbId,{streamInfo:s,hasAudio:e.hasAudio}),setTimeout((function(){t.initData()}),1e3)})).finally((function(){e.playLoading=!1}))},queryRecords:function(e){var t=e.gbId;this.$router.push("/channel/record/".concat(t))},queryCloudRecords:function(e){var t=this.deviceId,s=e.deviceId;this.$router.push("/cloudRecord/detail/rtp/".concat(t,"_").concat(s))},stopDevicePush:function(e){var t=this;this.$store.dispatch("commonChanel/stopPlayChannel",e.gbId).then((function(e){t.initData()})).catch((function(e){402===e.response.status?t.initData():console.log(e)}))},getSnap:function(e){var t=window.baseUrl?window.baseUrl:"";return t+"/api/device/query/snap/"+this.deviceId+"/"+e.deviceId},getBigSnap:function(e){return[this.getSnap(e)]},getSnapErrorEvent:function(e,t){var s=this;if("undefined"!==typeof this.loadSnap[e+t]){if(console.log("下载截图"+this.loadSnap[e+t]),this.loadSnap[e+t]>5)return void delete this.loadSnap[e+t];setTimeout((function(){var a="/api/device/query/snap/"+e+"/"+t;s.loadSnap[e+t]++,document.getElementById(e+t).setAttribute("src",a+"?"+(new Date).getTime())}),1e3)}},search:function(){this.currentPage=1,this.total=0,this.initData()},refresh:function(){this.initData()},handleEdit:function(e){console.log(e),this.editId=e.gbId},closeEdit:function(){this.editId=null,this.getChannelList()},moreClick:function(e,t){"records"===e?this.queryRecords(t):"cloudRecords"===e&&this.queryCloudRecords(t)}}},ae=se,oe=Object(b["a"])(ae,a,o,!1,null,null,null);t["default"]=oe.exports},a15b:function(e,t,s){"use strict";var a=s("23e7"),o=s("44ad"),n=s("fc6a"),i=s("a640"),r=[].join,l=o!=Object,c=i("join",",");a({target:"Array",proto:!0,forced:l||!c},{join:function(e){return r.call(n(this),void 0===e?",":e)}})},b680:function(e,t,s){"use strict";var a=s("23e7"),o=s("a691"),n=s("408a"),i=s("1148"),r=s("d039"),l=1..toFixed,c=Math.floor,d=function(e,t,s){return 0===t?s:t%2===1?d(e,t-1,s*e):d(e*e,t/2,s)},u=function(e){var t=0,s=e;while(s>=4096)t+=12,s/=4096;while(s>=2)t+=1,s/=2;return t},m=l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r((function(){l.call({})}));a({target:"Number",proto:!0,forced:m},{toFixed:function(e){var t,s,a,r,l=n(this),m=o(e),p=[0,0,0,0,0,0],h="",f="0",b=function(e,t){var s=-1,a=t;while(++s<6)a+=e*p[s],p[s]=a%1e7,a=c(a/1e7)},g=function(e){var t=6,s=0;while(--t>=0)s+=p[t],p[t]=c(s/e),s=s%e*1e7},v=function(){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==p[e]){var s=String(p[e]);t=""===t?s:t+i.call("0",7-s.length)+s}return t};if(m<0||m>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(h="-",l=-l),l>1e-21)if(t=u(l*d(2,69,1))-69,s=t<0?l*d(2,-t,1):l/d(2,t,1),s*=4503599627370496,t=52-t,t>0){b(0,s),a=m;while(a>=7)b(1e7,0),a-=7;b(d(10,a,1),0),a=t-1;while(a>=23)g(1<<23),a-=23;g(1<<a),b(1,1),g(2),f=v()}else b(0,s),b(1<<-t,0),f=v()+i.call("0",m);return m>0?(r=f.length,f=h+(r<=m?"0."+i.call("0",m-r)+f:f.slice(0,r-m)+"."+f.slice(r-m))):f=h+f,f}})},c522:function(e,t,s){"use strict";s("fea6")},d017:function(e,t,s){},e4f7:function(e,t,s){"use strict";s("4da4")},e9c4:function(e,t,s){var a=s("23e7"),o=s("d066"),n=s("d039"),i=o("JSON","stringify"),r=/[\uD800-\uDFFF]/g,l=/^[\uD800-\uDBFF]$/,c=/^[\uDC00-\uDFFF]$/,d=function(e,t,s){var a=s.charAt(t-1),o=s.charAt(t+1);return l.test(e)&&!c.test(o)||c.test(e)&&!l.test(a)?"\\u"+e.charCodeAt(0).toString(16):e},u=n((function(){return'"\\udf06\\ud834"'!==i("\udf06\ud834")||'"\\udead"'!==i("\udead")}));i&&a({target:"JSON",stat:!0,forced:u},{stringify:function(e,t,s){var a=i.apply(null,arguments);return"string"==typeof a?a.replace(r,d):a}})},fea6:function(e,t,s){}}]);