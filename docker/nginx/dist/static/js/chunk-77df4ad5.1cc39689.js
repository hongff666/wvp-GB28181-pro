(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77df4ad5"],{"0328":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoging,expression:"isLoging"}],attrs:{id:"devicePlayer"}},[e.showVideoDialog?s("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"视频播放",top:"0","append-to-body":"","close-on-click-modal":!1,visible:e.showVideoDialog},on:{"update:visible":function(t){e.showVideoDialog=t},close:function(t){return e.close()}}},[s("div",{staticStyle:{width:"100%",height:"100%"}},[Object.keys(this.player).length>1?s("el-tabs",{attrs:{type:"card",stretch:!0},on:{"tab-click":e.changePlayer},model:{value:e.activePlayer,callback:function(t){e.activePlayer=t},expression:"activePlayer"}},[s("el-tab-pane",{attrs:{label:"Jessibuca",name:"jessibuca"}},["jessibuca"===e.activePlayer?s("jessibucaPlayer",{ref:"jessibuca",attrs:{visible:e.showVideoDialog,"video-url":e.videoUrl,error:e.videoError,message:e.videoError,"has-audio":e.hasAudio,fluent:"",autoplay:"",live:""},on:{"update:visible":function(t){e.showVideoDialog=t}}}):e._e()],1),s("el-tab-pane",{attrs:{label:"WebRTC",name:"webRTC"}},["webRTC"===e.activePlayer?s("rtc-player",{ref:"webRTC",attrs:{visible:e.showVideoDialog,"video-url":e.videoUrl,error:e.videoError,message:e.videoError,height:"100px","has-audio":e.hasAudio,fluent:"",autoplay:"",live:""},on:{"update:visible":function(t){e.showVideoDialog=t}}}):e._e()],1),s("el-tab-pane",{attrs:{label:"h265web",name:"h265web"}},["h265web"===e.activePlayer?s("h265web",{ref:"h265web",attrs:{"video-url":e.videoUrl,error:e.videoError,message:e.videoError,"has-audio":e.hasAudio,fluent:"",autoplay:"",live:"","show-button":!0}}):e._e()],1)],1):e._e(),1==Object.keys(this.player).length&&this.player.jessibuca?s("jessibucaPlayer",{ref:"jessibuca",attrs:{visible:e.showVideoDialog,"video-url":e.videoUrl,error:e.videoError,message:e.videoError,"has-audio":e.hasAudio,fluent:"",autoplay:"",live:""},on:{"update:visible":function(t){e.showVideoDialog=t}}}):e._e(),1==Object.keys(this.player).length&&this.player.webRTC?s("rtc-player",{ref:"jessibuca",attrs:{visible:e.showVideoDialog,"video-url":e.videoUrl,error:e.videoError,message:e.videoError,height:"100px","has-audio":e.hasAudio,fluent:"",autoplay:"",live:""},on:{"update:visible":function(t){e.showVideoDialog=t}}}):e._e(),1==Object.keys(this.player).length&&this.player.h265web?s("h265web",{ref:"jessibuca",attrs:{visible:e.showVideoDialog,"video-url":e.videoUrl,error:e.videoError,message:e.videoError,height:"100px","has-audio":e.hasAudio,fluent:"",autoplay:"",live:""},on:{"update:visible":function(t){e.showVideoDialog=t}}}):e._e()],1),s("div",{staticStyle:{"text-align":"right","margin-top":"1rem"},attrs:{id:"shared"}},[s("el-tabs",{on:{"tab-click":e.tabHandleClick},model:{value:e.tabActiveName,callback:function(t){e.tabActiveName=t},expression:"tabActiveName"}},[s("el-tab-pane",{attrs:{label:"实时视频",name:"media"}},[s("div",{staticStyle:{display:"flex","margin-bottom":"0.5rem",height:"2.5rem"}},[s("span",{staticStyle:{width:"5rem","line-height":"2.5rem","text-align":"right"}},[e._v("播放地址：")]),s("el-input",{attrs:{disabled:!0},model:{value:e.getPlayerShared.sharedUrl,callback:function(t){e.$set(e.getPlayerShared,"sharedUrl",t)},expression:"getPlayerShared.sharedUrl"}},[s("template",{slot:"append"},[s("i",{staticClass:"cpoy-btn el-icon-document-copy",staticStyle:{cursor:"pointer"},attrs:{title:"点击拷贝"},on:{click:function(t){return e.copyUrl(e.getPlayerShared.sharedUrl)}}})])],2)],1),s("div",{staticStyle:{display:"flex","margin-bottom":"0.5rem",height:"2.5rem"}},[s("span",{staticStyle:{width:"5rem","line-height":"2.5rem","text-align":"right"}},[e._v("iframe：")]),s("el-input",{attrs:{disabled:!0},model:{value:e.getPlayerShared.sharedIframe,callback:function(t){e.$set(e.getPlayerShared,"sharedIframe",t)},expression:"getPlayerShared.sharedIframe"}},[s("template",{slot:"append"},[s("i",{staticClass:"cpoy-btn el-icon-document-copy",staticStyle:{cursor:"pointer"},attrs:{title:"点击拷贝"},on:{click:function(t){return e.copyUrl(e.getPlayerShared.sharedIframe)}}})])],2)],1),s("div",{staticStyle:{display:"flex","margin-bottom":"0.5rem",height:"2.5rem"}},[s("span",{staticStyle:{width:"5rem","line-height":"2.5rem","text-align":"right"}},[e._v("资源地址：")]),s("el-input",{attrs:{disabled:!0},model:{value:e.getPlayerShared.sharedRtmp,callback:function(t){e.$set(e.getPlayerShared,"sharedRtmp",t)},expression:"getPlayerShared.sharedRtmp"}},[s("el-button",{staticStyle:{cursor:"pointer"},attrs:{slot:"append",icon:"el-icon-document-copy",title:"点击拷贝"},on:{click:function(t){return e.copyUrl(e.getPlayerShared.sharedIframe)}},slot:"append"}),e.streamInfo?s("el-dropdown",{attrs:{slot:"prepend",trigger:"click"},on:{command:e.copyUrl},slot:"prepend"},[s("el-button",[e._v(" 更多地址"),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),s("el-dropdown-menu",[e.streamInfo.flv?s("el-dropdown-item",{attrs:{command:e.streamInfo.flv}},[s("el-tag",[e._v("FLV:")]),s("span",[e._v(e._s(e.streamInfo.flv))])],1):e._e(),e.streamInfo.https_flv?s("el-dropdown-item",{attrs:{command:e.streamInfo.https_flv}},[s("el-tag",[e._v("FLV(https):")]),s("span",[e._v(e._s(e.streamInfo.https_flv))])],1):e._e(),e.streamInfo.ws_flv?s("el-dropdown-item",{attrs:{command:e.streamInfo.ws_flv}},[s("el-tag",[e._v("FLV(ws):")]),s("span",[e._v(e._s(e.streamInfo.ws_flv))])],1):e._e(),e.streamInfo.wss_flv?s("el-dropdown-item",{attrs:{command:e.streamInfo.wss_flv}},[s("el-tag",[e._v("FLV(wss):")]),s("span",[e._v(e._s(e.streamInfo.wss_flv))])],1):e._e(),e.streamInfo.fmp4?s("el-dropdown-item",{attrs:{command:e.streamInfo.fmp4}},[s("el-tag",[e._v("FMP4:")]),s("span",[e._v(e._s(e.streamInfo.fmp4))])],1):e._e(),e.streamInfo.https_fmp4?s("el-dropdown-item",{attrs:{command:e.streamInfo.https_fmp4}},[s("el-tag",[e._v("FMP4(https):")]),s("span",[e._v(e._s(e.streamInfo.https_fmp4))])],1):e._e(),e.streamInfo.ws_fmp4?s("el-dropdown-item",{attrs:{command:e.streamInfo.ws_fmp4}},[s("el-tag",[e._v("FMP4(ws):")]),s("span",[e._v(e._s(e.streamInfo.ws_fmp4))])],1):e._e(),e.streamInfo.wss_fmp4?s("el-dropdown-item",{attrs:{command:e.streamInfo.wss_fmp4}},[s("el-tag",[e._v("FMP4(wss):")]),s("span",[e._v(e._s(e.streamInfo.wss_fmp4))])],1):e._e(),e.streamInfo.hls?s("el-dropdown-item",{attrs:{command:e.streamInfo.hls}},[s("el-tag",[e._v("HLS:")]),s("span",[e._v(e._s(e.streamInfo.hls))])],1):e._e(),e.streamInfo.https_hls?s("el-dropdown-item",{attrs:{command:e.streamInfo.https_hls}},[s("el-tag",[e._v("HLS(https):")]),s("span",[e._v(e._s(e.streamInfo.https_hls))])],1):e._e(),e.streamInfo.ws_hls?s("el-dropdown-item",{attrs:{command:e.streamInfo.ws_hls}},[s("el-tag",[e._v("HLS(ws):")]),s("span",[e._v(e._s(e.streamInfo.ws_hls))])],1):e._e(),e.streamInfo.wss_hls?s("el-dropdown-item",{attrs:{command:e.streamInfo.wss_hls}},[s("el-tag",[e._v("HLS(wss):")]),s("span",[e._v(e._s(e.streamInfo.wss_hls))])],1):e._e(),e.streamInfo.ts?s("el-dropdown-item",{attrs:{command:e.streamInfo.ts}},[s("el-tag",[e._v("TS:")]),s("span",[e._v(e._s(e.streamInfo.ts))])],1):e._e(),e.streamInfo.https_ts?s("el-dropdown-item",{attrs:{command:e.streamInfo.https_ts}},[s("el-tag",[e._v("TS(https):")]),s("span",[e._v(e._s(e.streamInfo.https_ts))])],1):e._e(),e.streamInfo.ws_ts?s("el-dropdown-item",{attrs:{command:e.streamInfo.ws_ts}},[s("el-tag",[e._v("TS(ws):")]),s("span",[e._v(e._s(e.streamInfo.ws_ts))])],1):e._e(),e.streamInfo.wss_ts?s("el-dropdown-item",{attrs:{command:e.streamInfo.wss_ts}},[s("el-tag",[e._v("TS(wss):")]),s("span",[e._v(e._s(e.streamInfo.wss_ts))])],1):e._e(),e.streamInfo.rtc?s("el-dropdown-item",{attrs:{command:e.streamInfo.rtc}},[s("el-tag",[e._v("RTC:")]),s("span",[e._v(e._s(e.streamInfo.rtc))])],1):e._e(),e.streamInfo.rtcs?s("el-dropdown-item",{attrs:{command:e.streamInfo.rtcs}},[s("el-tag",[e._v("RTCS:")]),s("span",[e._v(e._s(e.streamInfo.rtcs))])],1):e._e(),e.streamInfo.rtmp?s("el-dropdown-item",{attrs:{command:e.streamInfo.rtmp}},[s("el-tag",[e._v("RTMP:")]),s("span",[e._v(e._s(e.streamInfo.rtmp))])],1):e._e(),e.streamInfo.rtmps?s("el-dropdown-item",{attrs:{command:e.streamInfo.rtmps}},[s("el-tag",[e._v("RTMPS:")]),s("span",[e._v(e._s(e.streamInfo.rtmps))])],1):e._e(),e.streamInfo.rtsp?s("el-dropdown-item",{attrs:{command:e.streamInfo.rtsp}},[s("el-tag",[e._v("RTSP:")]),s("span",[e._v(e._s(e.streamInfo.rtsp))])],1):e._e(),e.streamInfo.rtsps?s("el-dropdown-item",{attrs:{command:e.streamInfo.rtsps}},[s("el-tag",[e._v("RTSPS:")]),s("span",[e._v(e._s(e.streamInfo.rtsps))])],1):e._e()],1)],1):e._e()],1)],1)]),e.showPtz?s("el-tab-pane",{attrs:{label:"云台控制",name:"control"}},[s("div",{staticStyle:{display:"grid","grid-template-columns":"240px auto",height:"180px",overflow:"auto"}},[s("div",{staticStyle:{display:"grid","grid-template-columns":"6.25rem auto"}},[s("div",{staticClass:"control-wrapper"},[s("div",{staticClass:"control-btn control-top",on:{mousedown:function(t){return e.ptzCamera("up")},mouseup:function(t){return e.ptzCamera("stop")}}},[s("i",{staticClass:"el-icon-caret-top"}),s("div",{staticClass:"control-inner-btn control-inner"})]),s("div",{staticClass:"control-btn control-left",on:{mousedown:function(t){return e.ptzCamera("left")},mouseup:function(t){return e.ptzCamera("stop")}}},[s("i",{staticClass:"el-icon-caret-left"}),s("div",{staticClass:"control-inner-btn control-inner"})]),s("div",{staticClass:"control-btn control-bottom",on:{mousedown:function(t){return e.ptzCamera("down")},mouseup:function(t){return e.ptzCamera("stop")}}},[s("i",{staticClass:"el-icon-caret-bottom"}),s("div",{staticClass:"control-inner-btn control-inner"})]),s("div",{staticClass:"control-btn control-right",on:{mousedown:function(t){return e.ptzCamera("right")},mouseup:function(t){return e.ptzCamera("stop")}}},[s("i",{staticClass:"el-icon-caret-right"}),s("div",{staticClass:"control-inner-btn control-inner"})]),s("div",{staticClass:"control-round"},[s("div",{staticClass:"control-round-inner"},[s("i",{staticClass:"fa fa-pause-circle"})])]),s("div",{staticClass:"contro-speed",staticStyle:{position:"absolute",left:"4px",top:"7rem",width:"6.25rem"}},[s("el-slider",{attrs:{max:100},model:{value:e.controSpeed,callback:function(t){e.controSpeed=t},expression:"controSpeed"}})],1)]),s("div",[s("div",{staticClass:"ptz-btn-box"},[s("div",{attrs:{title:"变倍+"},on:{mousedown:function(t){return e.ptzCamera("zoomin")},mouseup:function(t){return e.ptzCamera("stop")}}},[s("i",{staticClass:"el-icon-zoom-in control-zoom-btn",staticStyle:{"font-size":"1.5rem"}})]),s("div",{attrs:{title:"变倍-"},on:{mousedown:function(t){return e.ptzCamera("zoomout")},mouseup:function(t){return e.ptzCamera("stop")}}},[s("i",{staticClass:"el-icon-zoom-out control-zoom-btn",staticStyle:{"font-size":"1.5rem"}})])]),s("div",{staticClass:"ptz-btn-box"},[s("div",{attrs:{title:"聚焦+"},on:{mousedown:function(t){return e.focusCamera("near")},mouseup:function(t){return e.focusCamera("stop")}}},[s("i",{staticClass:"iconfont icon-bianjiao-fangda control-zoom-btn",staticStyle:{"font-size":"1.5rem"}})]),s("div",{attrs:{title:"聚焦-"},on:{mousedown:function(t){return e.focusCamera("far")},mouseup:function(t){return e.focusCamera("stop")}}},[s("i",{staticClass:"iconfont icon-bianjiao-suoxiao control-zoom-btn",staticStyle:{"font-size":"1.5rem"}})])]),s("div",{staticClass:"ptz-btn-box"},[s("div",{attrs:{title:"光圈+"},on:{mousedown:function(t){return e.irisCamera("in")},mouseup:function(t){return e.irisCamera("stop")}}},[s("i",{staticClass:"iconfont icon-guangquan control-zoom-btn",staticStyle:{"font-size":"1.5rem"}})]),s("div",{attrs:{title:"光圈-"},on:{mousedown:function(t){return e.irisCamera("out")},mouseup:function(t){return e.irisCamera("stop")}}},[s("i",{staticClass:"iconfont icon-guangquan- control-zoom-btn",staticStyle:{"font-size":"1.5rem"}})])])])]),"control"===e.tabActiveName?s("div",{staticStyle:{"text-align":"left"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini",placeholder:"请选择云台功能"},model:{value:e.ptzMethod,callback:function(t){e.ptzMethod=t},expression:"ptzMethod"}},[s("el-option",{attrs:{label:"预置点",value:"preset"}}),s("el-option",{attrs:{label:"巡航组",value:"cruise"}}),s("el-option",{attrs:{label:"自动扫描",value:"scan"}}),s("el-option",{attrs:{label:"雨刷",value:"wiper"}}),s("el-option",{attrs:{label:"辅助开关",value:"switch"}})],1),"preset"===e.ptzMethod?s("ptzPreset",{staticStyle:{"margin-top":"1rem"},attrs:{"channel-device-id":e.channelId,"device-id":e.deviceId}}):e._e(),"cruise"===e.ptzMethod?s("ptzCruising",{staticStyle:{"margin-top":"1rem"},attrs:{"channel-device-id":e.channelId,"device-id":e.deviceId}}):e._e(),"scan"===e.ptzMethod?s("ptzScan",{staticStyle:{"margin-top":"1rem"},attrs:{"channel-device-id":e.channelId,"device-id":e.deviceId}}):e._e(),"wiper"===e.ptzMethod?s("ptzWiper",{staticStyle:{"margin-top":"1rem"},attrs:{"channel-device-id":e.channelId,"device-id":e.deviceId}}):e._e(),"switch"===e.ptzMethod?s("ptzSwitch",{staticStyle:{"margin-top":"1rem"},attrs:{"channel-device-id":e.channelId,"device-id":e.deviceId}}):e._e()],1):e._e()])]):e._e(),s("el-tab-pane",{attrs:{label:"编码信息",name:"codec"}},[s("mediaInfo",{ref:"mediaInfo",attrs:{app:e.app,stream:e.streamId,"media-server-id":e.mediaServerId}})],1),e.showBroadcast?s("el-tab-pane",{attrs:{label:"语音对讲",name:"broadcast"}},[s("div",{staticStyle:{padding:"0 10px"}},[s("el-radio-group",{attrs:{disabled:-1!==e.broadcastStatus},model:{value:e.broadcastMode,callback:function(t){e.broadcastMode=t},expression:"broadcastMode"}},[s("el-radio",{attrs:{label:!0}},[e._v("喊话(Broadcast)")]),s("el-radio",{attrs:{label:!1}},[e._v("对讲(Talk)")])],1)],1),s("div",{staticClass:"trank",staticStyle:{"text-align":"center"}},[s("el-button",{staticStyle:{"font-size":"32px",padding:"24px","margin-top":"24px"},attrs:{type:e.getBroadcastStatus(),disabled:-2===e.broadcastStatus,circle:"",icon:"el-icon-microphone"},on:{click:function(t){return e.broadcastStatusClick()}}}),s("p",[-2===e.broadcastStatus?s("span",[e._v("正在释放资源")]):e._e(),-1===e.broadcastStatus?s("span",[e._v("点击开始对讲")]):e._e(),0===e.broadcastStatus?s("span",[e._v("等待接通中...")]):e._e(),1===e.broadcastStatus?s("span",[e._v("请说话")]):e._e()])],1)]):e._e()],1)],1)]):e._e()],1)},a=[],o=(s("caad"),s("b0c0"),s("e9c4"),s("b64b"),s("2532"),s("a888")),n=s("1c46"),r=s.n(n),l=s("bbf2"),c=s("2655"),d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{width:"100%"},attrs:{id:"ptzPreset"}},[e._l(e.presetList,(function(t){return s("el-tag",{key:t.presetId,staticStyle:{"margin-right":"1rem",cursor:"pointer","margin-bottom":"0.6rem"},attrs:{closable:"",size:"mini"},on:{close:function(s){return e.delPreset(t)},click:function(s){return e.gotoPreset(t)}}},[e._v(" "+e._s(t.presetName?t.presetName:t.presetId)+" ")])})),e.inputVisible?s("el-input",{ref:"saveTagInput",staticStyle:{width:"300px","vertical-align":"bottom"},attrs:{min:"1",max:"255",placeholder:"预置位编号","addon-before":"预置位编号","addon-after":"(1-255)",size:"small"},scopedSlots:e._u([{key:"append",fn:function(){return[s("el-button",{on:{click:function(t){return e.addPreset()}}},[e._v("保存")]),s("el-button",{on:{click:function(t){return e.cancel()}}},[e._v("取消")])]},proxy:!0}],null,!1,3889715118),model:{value:e.ptzPresetId,callback:function(t){e.ptzPresetId=t},expression:"ptzPresetId"}}):s("el-button",{attrs:{size:"small"},on:{click:e.showInput}},[e._v("+ 添加")])],2)},u=[],m=(s("d3b7"),{name:"PtzPreset",components:{},props:["channelDeviceId","deviceId"],data:function(){return{presetList:[],inputVisible:!1,ptzPresetId:""}},created:function(){this.getPresetList()},methods:{getPresetList:function(){var e=this;this.$store.dispatch("frontEnd/queryPreset",[this.deviceId,this.channelDeviceId]).then((function(t){e.presetList=t,e.$nextTick((function(){e.$refs.channelListTable.doLayout()}))}))},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},addPreset:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("frontEnd/addPreset",[this.deviceId,this.channelDeviceId,this.ptzPresetId]).then((function(t){setTimeout((function(){e.inputVisible=!1,e.ptzPresetId="",e.getPresetList()}),1e3)})).catch((function(s){t.close(),e.inputVisible=!1,e.ptzPresetId="",e.$message({showClose:!0,message:s,type:"error"})})).finally((function(){t.close()}))},cancel:function(){this.inputVisible=!1,this.ptzPresetId=""},gotoPreset:function(e){var t=this;console.log(e),this.$store.dispatch("frontEnd/callPreset",[this.deviceId,this.channelDeviceId,e.presetId]).then((function(e){t.$message({showClose:!0,message:"调用成功",type:"success"})})).catch((function(e){t.$message({showClose:!0,message:e,type:"error"})}))},delPreset:function(e){var t=this;this.$confirm("确定删除此预置位","提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var s=t.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});t.$store.dispatch("frontEnd/deletePreset",[t.deviceId,t.channelDeviceId,e.presetId]).then((function(e){setTimeout((function(){t.getPresetList()}),1e3)})).catch((function(e){t.$message({showClose:!0,message:e,type:"error"})})).finally((function(){s.close()}))})).catch((function(){}))}}}),h=m,p=s("2877"),f=Object(p["a"])(h,d,u,!1,null,null,null),v=f.exports,g=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"ptzCruising"}},[s("div",{staticStyle:{display:"grid","grid-template-columns":"80px auto","line-height":"28px"}},[s("span",[e._v("巡航组号: ")]),s("el-input",{attrs:{min:"1",max:"255",placeholder:"巡航组号","addon-before":"巡航组号","addon-after":"(1-255)",size:"mini"},model:{value:e.cruiseId,callback:function(t){e.cruiseId=t},expression:"cruiseId"}})],1),s("p",e._l(e.presetList,(function(t,i){return s("el-tag",{key:t.presetId,staticStyle:{"margin-right":"1rem",cursor:"pointer"},attrs:{closable:""},on:{close:function(s){return e.delPreset(t,i)}}},[e._v(" "+e._s(t.presetName?t.presetName:t.presetId)+" ")])})),1),e.selectPresetVisible?s("el-form",{attrs:{size:"mini",inline:!0}},[s("el-form-item",[s("el-select",{attrs:{placeholder:"请选择预置点"},model:{value:e.selectPreset,callback:function(t){e.selectPreset=t},expression:"selectPreset"}},e._l(e.allPresetList,(function(e){return s("el-option",{key:e.presetId,attrs:{label:e.presetName,value:e}})})),1)],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.addCruisePoint}},[e._v("保存")]),s("el-button",{attrs:{type:"primary"},on:{click:e.cancelAddCruisePoint}},[e._v("取消")])],1)],1):s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.selectPresetVisible=!0}}},[e._v("添加巡航点")]),e.setSpeedVisible?s("el-form",{attrs:{size:"mini",inline:!0}},[s("el-form-item",[e.setSpeedVisible?s("el-input",{attrs:{min:"1",max:"4095",placeholder:"巡航速度","addon-before":"巡航速度","addon-after":"(1-4095)",size:"mini"},model:{value:e.cruiseSpeed,callback:function(t){e.cruiseSpeed=t},expression:"cruiseSpeed"}}):e._e()],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.setCruiseSpeed}},[e._v("保存")]),s("el-button",{on:{click:e.cancelSetCruiseSpeed}},[e._v("取消")])],1)],1):s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.setSpeedVisible=!0}}},[e._v("设置巡航速度")]),e.setTimeVisible?s("el-form",{attrs:{size:"mini",inline:!0}},[s("el-form-item",[s("el-input",{staticStyle:{width:"100%"},attrs:{min:"1",max:"4095",placeholder:"巡航停留时间(秒)","addon-before":"巡航停留时间(秒)","addon-after":"(1-4095)"},model:{value:e.cruiseTime,callback:function(t){e.cruiseTime=t},expression:"cruiseTime"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.setCruiseTime}},[e._v("保存")]),s("el-button",{on:{click:e.cancelSetCruiseTime}},[e._v("取消")])],1)],1):s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.setTimeVisible=!0}}},[e._v("设置巡航时间")]),s("el-button",{attrs:{size:"mini"},on:{click:e.startCruise}},[e._v("开始巡航")]),s("el-button",{attrs:{size:"mini"},on:{click:e.stopCruise}},[e._v("停止巡航")]),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:e.deleteCruise}},[e._v("删除巡航")])],1)},b=[],y=(s("a434"),{name:"PtzCruising",components:{},props:["channelDeviceId","deviceId"],data:function(){return{cruiseId:1,presetList:[],allPresetList:[],selectPreset:"",inputVisible:!1,selectPresetVisible:!1,setSpeedVisible:!1,setTimeVisible:!1,cruiseSpeed:"",cruiseTime:""}},created:function(){this.getPresetList()},methods:{getPresetList:function(){var e=this;this.$store.dispatch("frontEnd/queryPreset",[this.deviceId,this.channelDeviceId]).then((function(t){e.allPresetList=t}))},addCruisePoint:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("frontEnd/addPointForCruise",[this.deviceId,this.channelDeviceId,this.cruiseId,this.selectPreset.presetId]).then((function(t){e.presetList.push(e.selectPreset)})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.selectPreset="",e.selectPresetVisible=!1,t.close()}))},cancelAddCruisePoint:function(){this.selectPreset="",this.selectPresetVisible=!1},delPreset:function(e,t){var s=this,i=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("frontEnd/deletePointForCruise",[this.deviceId,this.channelDeviceId,this.cruiseId,e.presetId]).then((function(e){s.presetList.splice(t,1)})).catch((function(e){s.$message({showClose:!0,message:e,type:"error"})})).finally((function(){i.close()}))},deleteCruise:function(e,t){var s=this;this.$confirm("确定删除此巡航组","提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=s.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});s.$store.dispatch("frontEnd/deletePointForCruise",[s.deviceId,s.channelDeviceId,s.cruiseId,0]).then((function(e){s.presetList=[]})).catch((function(e){s.$message({showClose:!0,message:e,type:"error"})})).finally((function(){e.close()}))}))},setCruiseSpeed:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("frontEnd/setCruiseSpeed",[this.deviceId,this.channelDeviceId,this.cruiseId,this.cruiseSpeed]).then((function(t){e.$message({showClose:!0,message:"保存成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.cruiseSpeed="",e.setSpeedVisible=!1,t.close()}))},cancelSetCruiseSpeed:function(){this.cruiseSpeed="",this.setSpeedVisible=!1},setCruiseTime:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("frontEnd/setCruiseTime",[this.deviceId,this.channelDeviceId,this.cruiseId,this.cruiseTime]).then((function(t){e.$message({showClose:!0,message:"保存成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.setTimeVisible=!1,e.cruiseTime="",t.close()}))},cancelSetCruiseTime:function(){this.setTimeVisible=!1,this.cruiseTime=""},startCruise:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("frontEnd/startCruise",[this.deviceId,this.channelDeviceId,this.cruiseId]).then((function(t){e.$message({showClose:!0,message:"发送成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.setTimeVisible=!1,e.cruiseTime="",t.close()}))},stopCruise:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("frontEnd/stopCruise",[this.deviceId,this.channelDeviceId,this.cruiseId]).then((function(t){e.$message({showClose:!0,message:"发送成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.setTimeVisible=!1,e.cruiseTime="",t.close()}))}}}),w=y,I=(s("e8b4"),Object(p["a"])(w,g,b,!1,null,null,null)),S=I.exports,C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"ptzScan"}},[s("div",{staticStyle:{display:"grid","grid-template-columns":"80px auto","line-height":"28px"}},[s("span",[e._v("扫描组号: ")]),s("el-input",{attrs:{min:"1",max:"255",placeholder:"扫描组号","addon-before":"扫描组号","addon-after":"(1-255)",size:"mini"},model:{value:e.scanId,callback:function(t){e.scanId=t},expression:"scanId"}})],1),s("el-button",{attrs:{size:"mini"},on:{click:e.setScanLeft}},[e._v("设置左边界")]),s("el-button",{attrs:{size:"mini"},on:{click:e.setScanRight}},[e._v("设置右边界")]),e.setSpeedVisible?s("el-form",{attrs:{size:"mini",inline:!0}},[s("el-form-item",[e.setSpeedVisible?s("el-input",{attrs:{min:"1",max:"4095",placeholder:"巡航速度","addon-before":"巡航速度","addon-after":"(1-4095)",size:"mini"},model:{value:e.speed,callback:function(t){e.speed=t},expression:"speed"}}):e._e()],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.setSpeed}},[e._v("保存")]),s("el-button",{on:{click:e.cancelSetSpeed}},[e._v("取消")])],1)],1):s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.setSpeedVisible=!0}}},[e._v("设置扫描速度")]),s("el-button",{attrs:{size:"mini"},on:{click:e.startScan}},[e._v("开始自动扫描")]),s("el-button",{attrs:{size:"mini"},on:{click:e.stopScan}},[e._v("停止自动扫描")])],1)},_=[],k={name:"PtzScan",components:{},props:["channelDeviceId","deviceId"],data:function(){return{scanId:1,setSpeedVisible:!1,speed:""}},created:function(){},methods:{setSpeed:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("frontEnd/setSpeedForScan",[this.deviceId,this.channelDeviceId,this.scanId,this.speed]).then((function(t){e.$message({showClose:!0,message:"保存成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.speed="",e.setSpeedVisible=!1,t.close()}))},cancelSetSpeed:function(){this.speed="",this.setSpeedVisible=!1},setScanLeft:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("frontEnd/setLeftForScan",[this.deviceId,this.channelDeviceId,this.scanId]).then((function(t){e.$message({showClose:!0,message:"保存成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.speed="",e.setSpeedVisible=!1,t.close()}))},setScanRight:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("frontEnd/setRightForScan",[this.deviceId,this.channelDeviceId,this.scanId]).then((function(t){e.$message({showClose:!0,message:"保存成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){e.speed="",e.setSpeedVisible=!1,t.close()}))},startScan:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("frontEnd/startScan",[this.deviceId,this.channelDeviceId,this.scanId]).then((function(t){e.$message({showClose:!0,message:"发送成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){t.close()}))},stopScan:function(){var e=this,t=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("frontEnd/stopScan",[this.deviceId,this.channelDeviceId,this.scanId]).then((function(t){e.$message({showClose:!0,message:"发送成功",type:"success"})})).catch((function(t){e.$message({showClose:!0,message:t,type:"error"})})).finally((function(){t.close()}))}}},$=k,x=(s("fdc8"),Object(p["a"])($,C,_,!1,null,null,null)),P=x.exports,D=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"ptzWiper"}},[s("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.open("on")}}},[e._v("开启")]),s("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.open("off")}}},[e._v("关闭")])],1)},T=[],z={name:"PtzWiper",components:{},props:["channelDeviceId","deviceId"],data:function(){return{}},created:function(){},methods:{open:function(e){var t=this,s=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("frontEnd/wiper",[this.deviceId,this.channelDeviceId,e]).then((function(e){t.$message({showClose:!0,message:"保存成功",type:"success"})})).catch((function(e){t.$message({showClose:!0,message:e,type:"error"})})).finally((function(){s.close()}))}}},L=z,E=(s("a135"),Object(p["a"])(L,D,T,!1,null,null,null)),M=E.exports,R=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"ptzScan"}},[s("el-form",{attrs:{size:"mini",inline:!0}},[s("el-form-item",[s("el-input",{attrs:{min:"1",max:"4095",placeholder:"开关编号","addon-before":"开关编号","addon-after":"(2-255)",size:"mini"},model:{value:e.switchId,callback:function(t){e.switchId=t},expression:"switchId"}})],1),s("el-form-item",[s("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.open("on")}}},[e._v("开启")]),s("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.open("off")}}},[e._v("关闭")])],1)],1)],1)},A=[],N={name:"PtzScan",components:{},props:["channelDeviceId","deviceId"],data:function(){return{switchId:1}},created:function(){},methods:{open:function(e){var t=this,s=this.$loading({lock:!0,fullscreen:!0,text:"正在发送指令",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$store.dispatch("frontEnd/auxiliary",[this.deviceId,this.channelDeviceId,e,this.switchId]).then((function(e){t.$message({showClose:!0,message:"保存成功",type:"success"})})).catch((function(e){t.$message({showClose:!0,message:e,type:"error"})})).finally((function(){s.close()}))}}},B=N,U=(s("34c9"),Object(p["a"])(B,R,A,!1,null,null,null)),V=U.exports,F=s("3031"),j=s("4f91"),O={name:"DevicePlayer",directives:{elDragDialog:o["a"]},components:{H265web:j["a"],PtzPreset:v,PtzCruising:S,ptzScan:P,ptzWiper:M,ptzSwitch:V,mediaInfo:F["a"],jessibucaPlayer:c["default"],rtcPlayer:l["default"]},props:{},data:function(){return{video:"http://lndxyj.iqilu.com/public/upload/2019/10/14/8c001ea0c09cdc59a57829dabc8010fa.mp4",videoUrl:"",activePlayer:"jessibuca",player:{jessibuca:["ws_flv","wss_flv"],webRTC:["rtc","rtcs"],h265web:["ws_flv","wss_flv"]},showVideoDialog:!1,streamId:"",ptzMethod:"preset",ptzPresetId:"",app:"",mediaServerId:"",deviceId:"",channelId:"",tabActiveName:"media",hasAudio:!1,loadingRecords:!1,recordsLoading:!1,isLoging:!1,controSpeed:30,timeVal:0,timeMin:0,timeMax:1440,presetPos:1,cruisingSpeed:100,cruisingTime:5,cruisingGroup:0,scanSpeed:100,scanGroup:0,tracks:[],showPtz:!0,showBroadcast:!0,showRrecord:!0,sliderTime:0,seekTime:0,recordStartTime:0,showTimeText:"00:00:00",streamInfo:null,broadcastMode:!0,broadcastRtc:null,broadcastStatus:-1}},computed:{getPlayerShared:function(){return{sharedUrl:window.location.origin+"/#/play/wasm/"+encodeURIComponent(this.videoUrl),sharedIframe:'<iframe src="'+window.location.origin+"/#/play/wasm/"+encodeURIComponent(this.videoUrl)+'"></iframe>',sharedRtmp:this.videoUrl}}},created:function(){console.log("created"),console.log(this.player),this.broadcastStatus=-1,1===Object.keys(this.player).length&&(this.activePlayer=Object.keys(this.player)[0])},methods:{tabHandleClick:function(e,t){console.log(e),this.tracks=[],"codec"===e.name?this.$refs.mediaInfo.startTask():this.$refs.mediaInfo.stopTask()},changePlayer:function(e){console.log(this.player[e.name][0]),this.activePlayer=e.name,this.videoUrl=this.getUrlByStreamInfo(),console.log(this.videoUrl)},openDialog:function(e,t,s,i){if(!this.showVideoDialog)switch(this.tabActiveName=e,this.channelId=s,this.deviceId=t,this.streamId="",this.mediaServerId="",this.app="",this.videoUrl="",this.$refs[this.activePlayer]&&this.$refs[this.activePlayer].pause(),e){case"media":this.play(i.streamInfo,i.hasAudio);break;case"streamPlay":this.tabActiveName="media",this.showRrecord=!1,this.showPtz=!1,this.showBroadcast=!1,this.play(i.streamInfo,i.hasAudio);break;case"control":break}},play:function(e,t){this.streamInfo=e,this.hasAudio=t,this.isLoging=!1,this.videoUrl=this.getUrlByStreamInfo(),this.streamId=e.stream,this.app=e.app,this.mediaServerId=e.mediaServerId,this.playFromStreamInfo(!1,e)},getUrlByStreamInfo:function(){console.log(this.streamInfo);var e=this.streamInfo;return this.streamInfo.transcodeStream&&(e=this.streamInfo.transcodeStream),"https:"===location.protocol?this.videoUrl=e[this.player[this.activePlayer][1]]:this.videoUrl=e[this.player[this.activePlayer][0]],this.videoUrl},playFromStreamInfo:function(e,t){var s=this;this.showVideoDialog=!0,this.hasaudio=e&&this.hasaudio,this.$refs[this.activePlayer]?this.$refs[this.activePlayer].play(this.getUrlByStreamInfo(t)):this.$nextTick((function(){s.$refs[s.activePlayer].play(s.getUrlByStreamInfo(t))}))},close:function(){console.log("关闭视频"),this.$refs[this.activePlayer]&&this.$refs[this.activePlayer].pause(),this.videoUrl="",this.showVideoDialog=!1,this.stopBroadcast()},ptzCamera:function(e){console.log("云台控制："+e),this.$store.dispatch("frontEnd/ptz",[this.deviceId,this.channelId,e,parseInt(255*this.controSpeed/100),parseInt(255*this.controSpeed/100),parseInt(16*this.controSpeed/100)])},irisCamera:function(e){this.$store.dispatch("frontEnd/iris",[this.deviceId,this.channelId,e,parseInt(255*this.controSpeed/100)])},focusCamera:function(e){this.$store.dispatch("frontEnd/focus",[this.deviceId,this.channelId,e,parseInt(255*this.controSpeed/100)])},videoError:function(e){console.log("播放器错误："+JSON.stringify(e))},copyUrl:function(e){var t=this;console.log(e),this.$copyText(e).then((function(e){t.$message.success({showClose:!0,message:"成功拷贝到粘贴板"})}),(function(e){}))},getBroadcastStatus:function(){return-2==this.broadcastStatus||-1==this.broadcastStatus?"primary":0==this.broadcastStatus?"warning":1===this.broadcastStatus?"danger":void 0},broadcastStatusClick:function(){var e=this;-1===this.broadcastStatus?(this.broadcastStatus=0,this.$store.dispatch("play/broadcastStart",[this.deviceId,this.channelId,this.broadcastMode]).then((function(t){var s=t.streamInfo;document.location.protocol.includes("https")?e.startBroadcast(s.rtcs):e.startBroadcast(s.rtc)}))):1===this.broadcastStatus&&(this.broadcastStatus=-1,this.broadcastRtc.close())},startBroadcast:function(e){var t=this;this.$store.dispatch("user/getUserInfo").then((function(s){if(null!=s){var i=s.pushKey;e+="&sign="+r.a.createHash("md5").update(i,"utf8").digest("hex"),console.log("开始语音喊话： "+e),t.broadcastRtc=new ZLMRTCClient.Endpoint({debug:!0,zlmsdpUrl:e,simulecast:!1,useCamera:!1,audioEnable:!0,videoEnable:!1,recvOnly:!1}),t.broadcastRtc.on(ZLMRTCClient.Events.WEBRTC_NOT_SUPPORT,(function(e){console.error("不支持webrtc",e),t.$message({showClose:!0,message:"不支持webrtc, 无法进行语音喊话",type:"error"}),t.broadcastStatus=-1})),t.broadcastRtc.on(ZLMRTCClient.Events.WEBRTC_ICE_CANDIDATE_ERROR,(function(e){console.error("ICE 协商出错"),t.$message({showClose:!0,message:"ICE 协商出错",type:"error"}),t.broadcastStatus=-1})),t.broadcastRtc.on(ZLMRTCClient.Events.WEBRTC_OFFER_ANWSER_EXCHANGE_FAILED,(function(e){console.error("offer anwser 交换失败",e),t.$message({showClose:!0,message:"offer anwser 交换失败"+e,type:"error"}),t.broadcastStatus=-1})),t.broadcastRtc.on(ZLMRTCClient.Events.WEBRTC_ON_CONNECTION_STATE_CHANGE,(function(e){console.log("状态改变",e),"connecting"===e?t.broadcastStatus=0:"connected"===e?t.broadcastStatus=1:"disconnected"===e&&(t.broadcastStatus=-1)})),t.broadcastRtc.on(ZLMRTCClient.Events.CAPTURE_STREAM_FAILED,(function(e){console.log("捕获流失败",e),t.$message({showClose:!0,message:"捕获流失败"+e,type:"error"}),t.broadcastStatus=-1}))}else t.broadcastStatus=-1})).catch((function(e){t.$message({showClose:!0,message:e,type:"error"}),t.broadcastStatus=-1}))},stopBroadcast:function(){this.broadcastRtc.close(),this.broadcastStatus=-1,this.$store.dispatch("play/broadcastStop",[this.deviceId,this.channelId])}}},G=O,q=(s("28ce"),Object(p["a"])(G,i,a,!1,null,null,null));t["a"]=q.exports},"0868":function(e,t,s){},1148:function(e,t,s){"use strict";var i=s("a691"),a=s("1d80");e.exports="".repeat||function(e){var t=String(a(this)),s="",o=i(e);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(s+=t);return s}},"257e":function(e,t,s){"use strict";s("d017")},"26d6":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container",attrs:{id:"device"}},[s("deviceList",{directives:[{name:"show",rawName:"v-show",value:null===e.deviceId,expression:"deviceId === null"}],on:{"show-channel":e.showChannelList}}),null!==e.deviceId?s("channelList",{attrs:{"device-id":e.deviceId},on:{"show-device":e.showDevice}}):e._e()],1)},a=[],o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{height:"calc(100vh - 124px)"},attrs:{id:"app"}},[s("el-form",{attrs:{inline:!0,size:"mini"}},[s("el-form-item",{attrs:{label:"搜索"}},[s("el-input",{staticStyle:{"margin-right":"1rem",width:"auto"},attrs:{placeholder:"关键字","prefix-icon":"el-icon-search",clearable:""},on:{input:e.initData},model:{value:e.searchStr,callback:function(t){e.searchStr=t},expression:"searchStr"}})],1),s("el-form-item",{attrs:{label:"在线状态"}},[s("el-select",{staticStyle:{width:"8rem","margin-right":"1rem"},attrs:{placeholder:"请选择","default-first-option":""},on:{change:e.initData},model:{value:e.online,callback:function(t){e.online=t},expression:"online"}},[s("el-option",{attrs:{label:"全部",value:""}}),s("el-option",{attrs:{label:"在线",value:"true"}}),s("el-option",{attrs:{label:"离线",value:"false"}})],1)],1),s("el-form-item",[s("el-button",{staticStyle:{"margin-right":"1rem"},attrs:{icon:"el-icon-plus",type:"primary"},on:{click:e.add}},[e._v("添加设备")]),s("el-button",{staticStyle:{"margin-right":"1rem"},attrs:{icon:"el-icon-info"},on:{click:function(t){return e.showInfo()}}},[e._v("接入信息 ")])],1),s("el-form-item",{staticStyle:{float:"right"}},[s("el-button",{attrs:{icon:"el-icon-refresh-right",circle:"",loading:e.getDeviceListLoading},on:{click:function(t){return e.getDeviceList()}}})],1)],1),s("el-table",{attrs:{size:"small",data:e.deviceList,height:"calc(100% - 64px)","header-row-class-name":"table-header"}},[s("el-table-column",{attrs:{prop:"name",label:"名称","min-width":"160"}}),s("el-table-column",{attrs:{prop:"deviceId",label:"设备编号","min-width":"160"}}),s("el-table-column",{attrs:{label:"地址","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[t.row.hostAddress?s("el-tag",{attrs:{size:"medium"}},[e._v(e._s(t.row.transport.toLowerCase())+"://"+e._s(t.row.hostAddress))]):e._e(),t.row.hostAddress?e._e():s("el-tag",{attrs:{size:"medium"}},[e._v("未知")])],1)]}}])}),s("el-table-column",{attrs:{prop:"manufacturer",label:"厂家","min-width":"100"}}),s("el-table-column",{attrs:{label:"流传输模式","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:"请选择"},on:{change:function(s){return e.transportChange(t.row)}},model:{value:t.row.streamMode,callback:function(s){e.$set(t.row,"streamMode",s)},expression:"scope.row.streamMode"}},[s("el-option",{key:"UDP",attrs:{label:"UDP",value:"UDP"}}),s("el-option",{key:"TCP-ACTIVE",attrs:{label:"TCP主动模式",value:"TCP-ACTIVE"}}),s("el-option",{key:"TCP-PASSIVE",attrs:{label:"TCP被动模式",value:"TCP-PASSIVE"}})],1)]}}])}),s("el-table-column",{attrs:{label:"通道数","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{"font-size":"1rem"}},[e._v(e._s(t.row.channelCount))])]}}])}),s("el-table-column",{attrs:{label:"状态","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[t.row.onLine&&e.myServerId!==t.row.serverId?s("el-tag",{staticStyle:{"border-color":"#ecf1af"},attrs:{size:"medium"}},[e._v("在线 ")]):e._e(),t.row.onLine&&e.myServerId===t.row.serverId?s("el-tag",{attrs:{size:"medium"}},[e._v("在线 ")]):e._e(),t.row.onLine?e._e():s("el-tag",{attrs:{size:"medium",type:"info"}},[e._v("离线")])],1)]}}])}),s("el-table-column",{attrs:{label:"订阅","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-checkbox",{attrs:{label:"目录",checked:t.row.subscribeCycleForCatalog>0},on:{change:function(s){return e.subscribeForCatalog(t.row.id,s)}}}),s("el-checkbox",{attrs:{label:"位置",checked:t.row.subscribeCycleForMobilePosition>0},on:{change:function(s){return e.subscribeForMobilePosition(t.row.id,s)}}})]}}])}),s("el-table-column",{attrs:{prop:"keepaliveTime",label:"最近心跳","min-width":"140"}}),s("el-table-column",{attrs:{prop:"registerTime",label:"最近注册","min-width":"140"}}),s("el-table-column",{attrs:{label:"操作","min-width":"300",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text",size:"medium",disabled:0===t.row.online,icon:"el-icon-refresh"},on:{click:function(s){return e.refDevice(t.row)},mouseover:function(s){return e.getTooltipContent(t.row.deviceId)}}},[e._v("刷新 ")]),s("el-divider",{attrs:{direction:"vertical"}}),s("el-button",{attrs:{type:"text",size:"medium",icon:"el-icon-video-camera"},on:{click:function(s){return e.showChannelList(t.row)}}},[e._v("通道 ")]),s("el-divider",{attrs:{direction:"vertical"}}),s("el-button",{attrs:{size:"medium",icon:"el-icon-edit",type:"text"},on:{click:function(s){return e.edit(t.row)}}},[e._v("编辑")]),s("el-divider",{attrs:{direction:"vertical"}}),s("el-dropdown",{on:{command:function(s){e.moreClick(s,t.row)}}},[s("el-button",{attrs:{size:"medium",type:"text"}},[e._v(" 操作"),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),s("el-dropdown-menu",[s("el-dropdown-item",{staticStyle:{color:"#f56c6c"},attrs:{command:"delete"}},[e._v(" 删除 ")]),s("el-dropdown-item",{attrs:{command:"setGuard",disabled:!t.row.onLine}},[e._v(" 布防 ")]),s("el-dropdown-item",{attrs:{command:"resetGuard",disabled:!t.row.onLine}},[e._v(" 撤防 ")]),s("el-dropdown-item",{attrs:{command:"syncBasicParam",disabled:!t.row.onLine}},[e._v(" 基础配置同步 ")])],1)],1)]}}])})],1),s("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.currentPage,"page-size":e.count,"page-sizes":[15,25,35,50],layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.currentChange}}),s("deviceEdit",{ref:"deviceEdit"}),s("syncChannelProgress",{ref:"syncChannelProgress"}),s("configInfo",{ref:"configInfo"})],1)},n=[],r=s("c14f"),l=s("1da1"),c=(s("99af"),s("d3b7"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoging,expression:"isLoging"}],attrs:{id:"deviceEdit"}},[s("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"设备编辑",width:"40%",top:"2rem","close-on-click-modal":!1,visible:e.showDialog,"destroy-on-close":!0},on:{"update:visible":function(t){e.showDialog=t},close:function(t){return e.close()}}},[s("div",{staticStyle:{"margin-right":"50px"},attrs:{id:"shared"}},[s("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"设备编号",prop:"deviceId"}},[e.isEdit?s("el-input",{attrs:{disabled:""},model:{value:e.form.deviceId,callback:function(t){e.$set(e.form,"deviceId",t)},expression:"form.deviceId"}}):e._e(),e.isEdit?e._e():s("el-input",{attrs:{clearable:""},model:{value:e.form.deviceId,callback:function(t){e.$set(e.form,"deviceId",t)},expression:"form.deviceId"}})],1),s("el-form-item",{attrs:{label:"设备名称",prop:"name"}},[s("el-input",{attrs:{clearable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{clearable:""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),s("el-form-item",{attrs:{label:"收流IP",prop:"sdpIp"}},[s("el-input",{attrs:{type:"sdpIp",clearable:""},model:{value:e.form.sdpIp,callback:function(t){e.$set(e.form,"sdpIp",t)},expression:"form.sdpIp"}})],1),s("el-form-item",{attrs:{label:"流媒体ID",prop:"mediaServerId"}},[s("el-select",{staticStyle:{float:"left",width:"100%"},model:{value:e.form.mediaServerId,callback:function(t){e.$set(e.form,"mediaServerId",t)},expression:"form.mediaServerId"}},[s("el-option",{key:"auto",attrs:{label:"自动负载最小",value:"auto"}}),e._l(e.mediaServerList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.id,value:e.id}})}))],2)],1),s("el-form-item",{attrs:{label:"字符集",prop:"charset"}},[s("el-select",{staticStyle:{float:"left",width:"100%"},model:{value:e.form.charset,callback:function(t){e.$set(e.form,"charset",t)},expression:"form.charset"}},[s("el-option",{key:"GB2312",attrs:{label:"GB2312",value:"gb2312"}}),s("el-option",{key:"UTF-8",attrs:{label:"UTF-8",value:"utf-8"}})],1)],1),s("el-form-item",{attrs:{label:"其他选项"}},[s("el-checkbox",{staticStyle:{float:"left"},attrs:{label:"SSRC校验"},model:{value:e.form.ssrcCheck,callback:function(t){e.$set(e.form,"ssrcCheck",t)},expression:"form.ssrcCheck"}}),s("el-checkbox",{staticStyle:{float:"left"},attrs:{label:"作为消息通道"},model:{value:e.form.asMessageChannel,callback:function(t){e.$set(e.form,"asMessageChannel",t)},expression:"form.asMessageChannel"}}),s("el-checkbox",{staticStyle:{float:"left"},attrs:{label:"收到ACK后发流"},model:{value:e.form.broadcastPushAfterAck,callback:function(t){e.$set(e.form,"broadcastPushAfterAck",t)},expression:"form.broadcastPushAfterAck"}})],1),s("el-form-item",[s("div",{staticStyle:{float:"right"}},[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确认")]),s("el-button",{on:{click:e.close}},[e._v("取消")])],1)])],1)],1)])],1)}),d=[],u=s("a888"),m={name:"DeviceEdit",directives:{elDragDialog:u["a"]},props:{},data:function(){return{listChangeCallback:null,showDialog:!1,isLoging:!1,hostNames:[],mediaServerList:[],form:{},isEdit:!1,rules:{deviceId:[{required:!0,message:"请输入设备编号",trigger:"blur"}]}}},computed:{},created:function(){},methods:{openDialog:function(e,t){console.log(e),this.showDialog=!0,this.isEdit=!1,e&&(this.isEdit=!0),this.form={},this.listChangeCallback=t,null!=e&&(this.form=e),this.getMediaServerList()},getMediaServerList:function(){var e=this;this.$store.dispatch("server/getOnlineMediaServerList").then((function(t){e.mediaServerList=t}))},onSubmit:function(){var e=this;this.isEdit?this.$store.dispatch("device/update",this.form).then((function(t){e.listChangeCallback()})):this.$store.dispatch("device/add",this.form).then((function(t){e.listChangeCallback()}))},close:function(){this.showDialog=!1,this.$refs.form.resetFields()}}},h=m,p=s("2877"),f=Object(p["a"])(h,c,d,!1,null,null,null),v=f.exports,g=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoging,expression:"isLoging"}],attrs:{id:"SyncChannelProgress"}},[s("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticStyle:{"text-align":"center"},attrs:{width:"240px",top:"13%","append-to-body":!0,"close-on-click-modal":!1,visible:e.showDialog,"destroy-on-close":!0,"show-close":!0},on:{"update:visible":function(t){e.showDialog=t},close:function(t){return e.close()}}},[s("el-progress",{attrs:{type:"circle",percentage:e.percentage,status:e.syncStatus}}),s("div",{staticStyle:{"text-align":"center"}},[e._v(" "+e._s(e.msg)+" ")])],1)],1)},b=[],y=(s("a9e3"),{name:"SyncChannelProgress",directives:{elDragDialog:u["a"]},props:["platformId"],data:function(){return{endCallBack:null,syncStatus:null,percentage:0,total:0,current:0,showDialog:!1,isLoging:!1,syncFlag:!1,deviceId:null,timer:null,errorTimer:null,msg:"正在同步"}},computed:{},created:function(){},methods:{openDialog:function(e,t){console.log("deviceId: "+e),this.deviceId=e,this.showDialog=!0,this.msg="",this.percentage=0,this.total=0,this.current=0,this.syncFlag=!1,this.syncStatus=null,this.endCallBack=t,this.getProgress()},getProgress:function(){var e=this;this.$store.dispatch("device/queryDeviceSyncStatus",this.deviceId).then((function(t){var s=t.data,i=(t.code,t.msg);null===s?(e.msg=i,e.timer=setTimeout(e.getProgress,300)):s.syncIng?0===s.total?(e.msg="等待同步中",e.timer=setTimeout(e.getProgress,300)):(e.syncFlag=!0,e.total=s.total,e.current=s.current,e.percentage=Math.floor(Number(s.current)/Number(s.total)*1e4)/100,e.msg="同步中...[".concat(s.current,"/").concat(s.total,"]"),e.timer=setTimeout(e.getProgress,300)):s.errorMsg?(e.msg=s.errorMsg,e.syncStatus="exception"):(e.syncStatus="success",e.percentage=100,e.msg="同步成功",setTimeout((function(){e.showDialog=!1}),3e3))})).catch((function(t){console.log(t),e.syncStatus="error",e.msg=t,window.clearTimeout(e.errorTimer),e.errorTimer=setTimeout((function(){e.showDialog=!1}),2e3)}))},close:function(){this.endCallBack&&this.endCallBack(),window.clearTimeout(this.timer)}}}),w=y,I=Object(p["a"])(w,g,b,!1,null,null,null),S=I.exports,C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"configInfo"}},[s("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"接入信息",width:"=80%",top:"2rem","close-on-click-modal":!1,visible:e.showDialog,"destroy-on-close":!0},on:{"update:visible":function(t){e.showDialog=t},close:function(t){return e.close()}}},[s("div",{staticStyle:{"margin-top":"1rem","margin-right":"100px"},attrs:{id:"shared"}},[e.key&&"sip"!==e.key||!e.configInfoData.sip?e._e():s("el-descriptions",{attrs:{title:"国标服务信息",span:2}},[s("el-descriptions-item",{attrs:{label:"编号"}},[e._v(e._s(e.configInfoData.sip.id))]),s("el-descriptions-item",{attrs:{label:"域"}},[e._v(e._s(e.configInfoData.sip.domain))]),s("el-descriptions-item",{attrs:{label:"IP"}},[e._v(e._s(e.configInfoData.sip.showIp))]),s("el-descriptions-item",{attrs:{label:"端口"}},[e._v(e._s(e.configInfoData.sip.port))]),s("el-descriptions-item",{attrs:{label:"密码"}},[s("el-tag",{attrs:{size:"small"}},[e._v(e._s(e.configInfoData.sip.password))])],1)],1),"jt1078Config"===e.key&&e.configInfoData.jt1078Config?s("el-descriptions",{attrs:{title:"部标服务信息",span:2}},[s("el-descriptions-item",{attrs:{label:"端口"}},[e._v(e._s(e.configInfoData.jt1078Config.port))]),s("el-descriptions-item",{attrs:{label:"密码"}},[s("el-tag",{attrs:{size:"small"}},[e._v(e._s(e.configInfoData.jt1078Config.password))])],1)],1):e._e()],1)])],1)},_=[],k={name:"ConfigInfo",directives:{elDragDialog:u["a"]},props:{},data:function(){return{showDialog:!1,key:null,configInfoData:{sip:{}}}},computed:{},created:function(){},methods:{openDialog:function(e,t){console.log(e),this.showDialog=!0,this.key=t,this.configInfoData=e},close:function(){this.showDialog=!1}}},$=k,x=Object(p["a"])($,C,_,!1,null,null,null),P=x.exports,D=s("2b0e"),T={name:"App",components:{configInfo:P,deviceEdit:v,syncChannelProgress:S},data:function(){return{deviceList:[],currentDevice:{},searchStr:"",online:null,videoComponentList:[],updateLooper:0,currentDeviceChannelsLength:0,currentPage:1,count:15,total:0,getDeviceListLoading:!1}},computed:{Vue:function(){return D["default"]},myServerId:function(){return this.$store.getters.serverId}},mounted:function(){this.initData(),this.updateLooper=setInterval(this.getDeviceList,1e4)},destroyed:function(){this.$destroy("videojs"),clearTimeout(this.updateLooper)},methods:{initData:function(){this.currentPage=1,this.total=0,this.getDeviceList()},currentChange:function(e){this.currentPage=e,this.getDeviceList()},handleSizeChange:function(e){this.count=e,this.getDeviceList()},getDeviceList:function(){var e=this;this.getDeviceListLoading=!0,this.$store.dispatch("device/queryDevices",{page:this.currentPage,count:this.count,query:this.searchStr,status:this.online}).then((function(t){e.total=t.total,e.deviceList=t.list})).finally((function(){e.getDeviceListLoading=!1}))},deleteDevice:function(e){var t=this,s="确定删除此设备？";0!==e.online&&(s="在线设备删除后仍可通过注册再次上线。<br/>如需彻底删除请先将设备离线。<br/><strong>确定删除此设备？</strong>"),this.$confirm(s,"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",center:!0,type:"warning"}).then((function(){t.$store.dispatch("device/deleteDevice",e.deviceId).then((function(e){t.getDeviceList()}))}))},showChannelList:function(e){this.$emit("show-channel",e.deviceId)},showDevicePosition:function(e){this.$router.push("/map?deviceId=".concat(e.deviceId))},refDevice:function(e){var t=this;console.log("刷新对应设备:"+e.deviceId),this.$store.dispatch("device/sync",e.deviceId).then((function(s){s&&s.errorMsg?t.$message({showClose:!0,message:s.errorMsg,type:"error"}):t.$refs.syncChannelProgress.openDialog(e.deviceId,(function(){t.getDeviceList()}))})).finally((function(){t.getDeviceList()}))},getTooltipContent:function(){var e=Object(l["a"])(Object(r["a"])().m((function e(t){var s;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return s="",e.n=1,this.$store.dispatch("device/queryDeviceSyncStatus",t).then((function(e){null!==e.errorMsg&&(s=e.errorMsg),s="同步中...[".concat(e.current,"/").concat(e.total,"]")})).catch((function(e){s=e}));case 1:return e.a(2,s)}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),transportChange:function(e){console.log("修改传输方式为 ".concat(e.streamMode,"：").concat(e.deviceId," ")),console.log(e.streamMode),this.$store.dispatch("device/updateDeviceTransport",[e.deviceId,e.streamMode])},edit:function(e){var t=this;this.$refs.deviceEdit.openDialog(e,(function(){t.$refs.deviceEdit.close(),t.$message({showClose:!0,message:"设备修改成功，通道字符集将在下次更新生效",type:"success"}),setTimeout(t.getDeviceList,200)}))},add:function(){var e=this;this.$refs.deviceEdit.openDialog(null,(function(){e.$refs.deviceEdit.close(),e.$message({showClose:!0,message:"添加成功",type:"success"}),setTimeout(e.getDeviceList,200)}))},showInfo:function(){var e=this;this.$store.dispatch("server/getSystemConfig").then((function(t){e.serverId=t.addOn.serverId,e.$refs.configInfo.openDialog(t)}))},moreClick:function(e,t){"setGuard"===e?this.setGuard(t):"resetGuard"===e?this.resetGuard(t):"delete"===e?this.deleteDevice(t):"syncBasicParam"===e&&this.syncBasicParam(t)},setGuard:function(e){var t=this;this.$store.dispatch("device/setGuard",e.deviceId).then((function(e){t.$message.success({showClose:!0,message:"布防成功"})})).catch((function(e){t.$message.error({showClose:!0,message:e.message})}))},resetGuard:function(e){var t=this;this.$store.dispatch("device/resetGuard",e.deviceId).then((function(e){t.$message.success({showClose:!0,message:"撤防成功"})})).catch((function(e){t.$message.error({showClose:!0,message:e.message})}))},subscribeForCatalog:function(e,t){var s=this;this.$store.dispatch("device/subscribeCatalog",{id:e,cycle:t?60:0}).then((function(e){s.$message.success({showClose:!0,message:t?"订阅成功":"取消订阅成功"})})).catch((function(e){s.$message.error({showClose:!0,message:e.message})}))},subscribeForMobilePosition:function(e,t){var s=this;this.$store.dispatch("device/subscribeMobilePosition",{id:e,cycle:t?60:0,interval:t?5:0}).then((function(e){s.$message.success({showClose:!0,message:t?"订阅成功":"取消订阅成功"})})).catch((function(e){s.$message.error({showClose:!0,message:e.message})}))},syncBasicParam:function(e){var t=this;this.$store.dispatch("device/queryBasicParam").then((function(e){t.$message.success({showClose:!0,message:"配置已同步，当前心跳间隔： ".concat(e.BasicParam.HeartBeatInterval," 心跳间隔:").concat(res.data.data.BasicParam.HeartBeatCount)})})).catch((function(e){t.$message.error({showClose:!0,message:e.message})}))}}},z=T,L=Object(p["a"])(z,o,n,!1,null,null,null),E=L.exports,M=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{height:"calc(100vh - 124px)"},attrs:{id:"channelList"}},[e.editId?e._e():s("div",{staticStyle:{height:"100%"}},[s("el-form",{attrs:{inline:!0,size:"mini"}},[s("el-form-item",{staticStyle:{"margin-right":"2rem"}},[s("el-page-header",{attrs:{content:"通道列表"},on:{back:e.showDevice}})],1),s("el-form-item",{attrs:{label:"搜索"}},[s("el-input",{staticStyle:{"margin-right":"1rem",width:"auto"},attrs:{placeholder:"关键字","prefix-icon":"el-icon-search",clearable:""},on:{input:e.search},model:{value:e.searchStr,callback:function(t){e.searchStr=t},expression:"searchStr"}})],1),s("el-form-item",{attrs:{label:"通道类型"}},[s("el-select",{staticStyle:{width:"8rem","margin-right":"1rem"},attrs:{placeholder:"请选择","default-first-option":""},on:{change:e.search},model:{value:e.channelType,callback:function(t){e.channelType=t},expression:"channelType"}},[s("el-option",{attrs:{label:"全部",value:""}}),s("el-option",{attrs:{label:"设备",value:"false"}}),s("el-option",{attrs:{label:"子目录",value:"true"}})],1)],1),s("el-form-item",{attrs:{label:"在线状态"}},[s("el-select",{staticStyle:{width:"8rem","margin-right":"1rem"},attrs:{placeholder:"请选择","default-first-option":""},on:{change:e.search},model:{value:e.online,callback:function(t){e.online=t},expression:"online"}},[s("el-option",{attrs:{label:"全部",value:""}}),s("el-option",{attrs:{label:"在线",value:"true"}}),s("el-option",{attrs:{label:"离线",value:"false"}})],1)],1),s("el-form-item",{attrs:{label:"码流类型重置"}},[s("el-select",{staticStyle:{width:"16rem","margin-right":"1rem"},attrs:{placeholder:"请选择码流类型","default-first-option":""},on:{change:e.subStreamChange},model:{value:e.subStream,callback:function(t){e.subStream=t},expression:"subStream"}},[s("el-option",{attrs:{label:"stream:0(主码流)",value:"stream:0"}}),s("el-option",{attrs:{label:"stream:1(子码流)",value:"stream:1"}}),s("el-option",{attrs:{label:"streamnumber:0(主码流-2022)",value:"streamnumber:0"}}),s("el-option",{attrs:{label:"streamnumber:1(子码流-2022)",value:"streamnumber:1"}}),s("el-option",{attrs:{label:"streamprofile:0(主码流-大华)",value:"streamprofile:0"}}),s("el-option",{attrs:{label:"streamprofile:1(子码流-大华)",value:"streamprofile:1"}}),s("el-option",{attrs:{label:"streamMode:MAIN(主码流-水星+TP-LINK)",value:"streamMode:MAIN"}}),s("el-option",{attrs:{label:"streamMode:SUB(子码流-水星+TP-LINK)",value:"streamMode:SUB"}})],1)],1),s("el-form-item",{staticStyle:{float:"right"}},[s("el-button",{attrs:{icon:"el-icon-refresh-right",circle:""},on:{click:function(t){return e.refresh()}}})],1)],1),s("el-table",{ref:"channelListTable",staticStyle:{width:"100%","font-size":"12px"},attrs:{size:"small",data:e.deviceChannelList,height:"calc(100% - 64px)","header-row-class-name":"table-header"}},[s("el-table-column",{attrs:{prop:"name",label:"名称","min-width":"180"}}),s("el-table-column",{attrs:{prop:"deviceId",label:"编号","min-width":"180"}}),s("el-table-column",{attrs:{label:"快照","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-image",{staticStyle:{width:"60px"},attrs:{src:e.getSnap(t.row),"preview-src-list":e.getBigSnap(t.row),fit:"contain"},on:{error:function(s){return e.getSnapErrorEvent(t.row.deviceId,t.row.channelId)}}},[s("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[s("i",{staticClass:"el-icon-picture-outline"})])])]}}],null,!1,2328878535)}),s("el-table-column",{attrs:{prop:"manufacturer",label:"厂家","min-width":"100"}}),s("el-table-column",{attrs:{label:"位置信息","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.longitude&&t.row.latitude?s("span",[e._v(e._s(t.row.longitude)),s("br"),e._v(e._s(t.row.latitude))]):e._e(),t.row.longitude&&t.row.latitude?e._e():s("span",[e._v("无")])]}}],null,!1,1496757730)}),s("el-table-column",{attrs:{prop:"ptzType",label:"云台类型","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[e._v(e._s(t.row.ptzTypeText))])]}}],null,!1,867005290)}),s("el-table-column",{attrs:{label:"开启音频","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{attrs:{"active-color":"#409EFF"},on:{change:function(s){return e.updateChannel(t.row)}},model:{value:t.row.hasAudio,callback:function(s){e.$set(t.row,"hasAudio",s)},expression:"scope.row.hasAudio"}})]}}],null,!1,280923771)}),s("el-table-column",{attrs:{label:"码流类型","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-select",{staticStyle:{"margin-right":"1rem"},attrs:{size:"mini",placeholder:"请选择码流类型","default-first-option":""},on:{change:function(s){return e.channelSubStreamChange(t.row)}},model:{value:t.row.streamIdentification,callback:function(s){e.$set(t.row,"streamIdentification",s)},expression:"scope.row.streamIdentification"}},[s("el-option",{attrs:{label:"stream:0(主码流)",value:"stream:0"}}),s("el-option",{attrs:{label:"stream:1(子码流)",value:"stream:1"}}),s("el-option",{attrs:{label:"streamnumber:0(主码流-2022)",value:"streamnumber:0"}}),s("el-option",{attrs:{label:"streamnumber:1(子码流-2022)",value:"streamnumber:1"}}),s("el-option",{attrs:{label:"streamprofile:0(主码流-大华)",value:"streamprofile:0"}}),s("el-option",{attrs:{label:"streamprofile:1(子码流-大华)",value:"streamprofile:1"}}),s("el-option",{attrs:{label:"streamMode:MAIN(主码流-水星+TP-LINK)",value:"streamMode:MAIN"}}),s("el-option",{attrs:{label:"streamMode:SUB(子码流-水星+TP-LINK)",value:"streamMode:SUB"}})],1)]}}],null,!1,980399877)}),s("el-table-column",{attrs:{label:"状态","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},["ON"===t.row.status?s("el-tag",{attrs:{size:"medium"}},[e._v("在线")]):e._e(),"ON"!==t.row.status?s("el-tag",{attrs:{size:"medium",type:"info"}},[e._v("离线")]):e._e()],1)]}}],null,!1,2943336009)}),s("el-table-column",{attrs:{label:"操作","min-width":"340",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"medium",disabled:null==e.device||0===e.device.online,icon:"el-icon-video-play",type:"text",loading:t.row.playLoading},on:{click:function(s){return e.sendDevicePush(t.row)}}},[e._v("播放 ")]),t.row.streamId?s("el-button",{staticStyle:{color:"#f56c6c"},attrs:{size:"medium",disabled:null==e.device||0===e.device.online,icon:"el-icon-switch-button",type:"text"},on:{click:function(s){return e.stopDevicePush(t.row)}}},[e._v("停止 ")]):e._e(),s("el-divider",{attrs:{direction:"vertical"}}),s("el-button",{attrs:{size:"medium",type:"text",icon:"el-icon-edit"},on:{click:function(s){return e.handleEdit(t.row)}}},[e._v(" 编辑 ")]),s("el-divider",{attrs:{direction:"vertical"}}),t.row.subCount>0||1===t.row.parental||t.row.deviceId.length<=8?s("el-button",{attrs:{size:"medium",icon:"el-icon-s-open",type:"text"},on:{click:function(s){return e.changeSubchannel(t.row)}}},[e._v("查看 ")]):e._e(),t.row.subCount>0||1===t.row.parental||t.row.deviceId.length<=8?s("el-divider",{attrs:{direction:"vertical"}}):e._e(),s("el-dropdown",{on:{command:function(s){e.moreClick(s,t.row)}}},[s("el-button",{attrs:{size:"medium",type:"text"}},[e._v(" 更多"),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),s("el-dropdown-menu",[s("el-dropdown-item",{attrs:{command:"records",disabled:null==e.device||0===e.device.online}},[e._v(" 设备录像")]),s("el-dropdown-item",{attrs:{command:"cloudRecords",disabled:null==e.device||0===e.device.online}},[e._v(" 云端录像")]),s("el-dropdown-item",{attrs:{command:"record",disabled:null==e.device||0===e.device.online}},[e._v(" 设备录像控制-开始")]),s("el-dropdown-item",{attrs:{command:"stopRecord",disabled:null==e.device||0===e.device.online}},[e._v(" 设备录像控制-停止")])],1)],1)]}}],null,!1,289514641)})],1),s("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.currentPage,"page-size":e.count,"page-sizes":[15,25,35,50],layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.currentChange}})],1),s("devicePlayer",{ref:"devicePlayer"}),e.editId?s("channel-edit",{attrs:{id:e.editId,"close-edit":e.closeEdit}}):e._e()],1)},R=[],A=(s("b0c0"),s("0643"),s("4e3e"),s("159b"),s("0328")),N=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.locading,expression:"locading"}],staticStyle:{width:"100%"},attrs:{id:"ChannelEdit"}},[s("div",{staticClass:"page-header"},[s("div",{staticClass:"page-title"},[s("el-page-header",{attrs:{content:"编辑通道"},on:{back:e.close}})],1)]),s("CommonChannelEdit",{ref:"commonChannelEdit",attrs:{id:e.id,"save-success":e.close,cancel:e.close}})],1)},B=[],U=s("7317"),V={name:"ChannelEdit",components:{CommonChannelEdit:U["a"]},props:["id","closeEdit"],data:function(){return{}},methods:{close:function(){this.closeEdit()}}},F=V,j=Object(p["a"])(F,N,B,!1,null,null,null),O=j.exports,G={name:"ChannelList",components:{devicePlayer:A["a"],ChannelEdit:O},props:{defaultPage:{type:Number,default:1},defaultCount:{type:Number,default:15},deviceId:{type:String,default:null},parentChannelId:{type:String||null,default:null}},data:function(){return{device:null,deviceChannelList:[],videoComponentList:[],currentPlayerInfo:{},updateLooper:0,searchStr:"",channelType:"",online:"",subStream:"",winHeight:window.innerHeight-200,currentPage:1|this.defaultPage,count:15|this.defaultCount,total:0,beforeUrl:"/device",editId:null,loadSnap:{},ptzTypes:{0:"未知",1:"球机",2:"半球",3:"固定枪机",4:"遥控枪机"}}},watch:{deviceId:function(e){var t=this;this.$store.dispatch("device/queryDeviceOne",this.deviceId).then((function(e){t.device=e})),this.initData()}},mounted:function(){var e=this;console.log(23222),this.deviceId&&this.$store.dispatch("device/queryDeviceOne",this.deviceId).then((function(t){e.device=t})),this.initData()},destroyed:function(){this.$destroy("videojs"),clearTimeout(this.updateLooper)},methods:{initData:function(){null===this.parentChannelId||"undefined"===typeof this.parentChannelId||0===this.parentChannelId?this.getDeviceChannelList():this.showSubChannels()},initParam:function(){this.deviceId=this.$route.params.deviceId,this.parentChannelId=this.$route.params.parentChannelId,this.currentPage=1,this.count=15,""!==this.parentChannelId&&0!==this.parentChannelId||(this.beforeUrl="/device/list")},currentChange:function(e){this.currentPage=e,this.initData()},handleSizeChange:function(e){this.count=e,this.getDeviceChannelList()},getDeviceChannelList:function(){var e=this;console.log(this.deviceId),"undefined"!==typeof this.deviceId&&this.$store.dispatch("device/queryChannels",[this.deviceId,{page:this.currentPage,count:this.count,query:this.searchStr,online:this.online,channelType:this.channelType}]).then((function(t){e.total=t.total,e.deviceChannelList=t.list,e.deviceChannelList.forEach((function(t){t.ptzType=t.ptzType+"",e.$set(t,"playLoading",!1)})),e.$nextTick((function(){e.$refs.channelListTable.doLayout()}))}))},sendDevicePush:function(e){var t=this,s=this.deviceId,i=e.deviceId;e.playLoading=!0,console.log("通知设备推流1："+s+" : "+i),this.$store.dispatch("play/play",[s,i]).then((function(a){setTimeout((function(){var e=s+"_"+i;t.loadSnap[s+i]=0,t.getSnapErrorEvent(e)}),5e3),e.streamId=a.stream,t.$refs.devicePlayer.openDialog("media",s,i,{streamInfo:a,hasAudio:e.hasAudio}),setTimeout((function(){t.initData()}),1e3)})).finally((function(){e.playLoading=!1}))},moreClick:function(e,t){"records"===e?this.queryRecords(t):"cloudRecords"===e?this.queryCloudRecords(t):"record"===e?this.startRecord(t):"stopRecord"===e&&this.stopRecord(t)},queryRecords:function(e){var t=this.deviceId,s=e.deviceId;this.$router.push("/device/record/".concat(t,"/").concat(s))},queryCloudRecords:function(e){var t=this.deviceId,s=e.deviceId;this.$router.push("/cloudRecord/detail/rtp/".concat(t,"_").concat(s))},startRecord:function(e){var t=this;this.$store.dispatch("device/deviceRecord",{deviceId:this.deviceId,channelId:e.deviceId,recordCmdStr:"Record"}).then((function(e){t.$message.success({showClose:!0,message:"开始录像成功"})})).catch((function(e){t.$message.error({showClose:!0,message:e.message})}))},stopRecord:function(e){var t=this;this.$store.dispatch("device/deviceRecord",{deviceId:this.deviceId,channelId:e.deviceId,recordCmdStr:"StopRecord"}).then((function(e){t.$message.success({showClose:!0,message:"停止录像成功"})})).catch((function(e){t.$message.error({showClose:!0,message:e.message})}))},stopDevicePush:function(e){var t=this;this.$store.dispatch("play/stop",[this.deviceId,e.deviceId]).then((function(e){t.initData()})).catch((function(e){402===e.response.status?t.initData():console.log(e)}))},getSnap:function(e){var t=window.baseUrl?window.baseUrl:"";return t+"/api/device/query/snap/"+this.deviceId+"/"+e.deviceId},getBigSnap:function(e){return[this.getSnap(e)]},getSnapErrorEvent:function(e,t){var s=this;if("undefined"!==typeof this.loadSnap[e+t]){if(console.log("下载截图"+this.loadSnap[e+t]),this.loadSnap[e+t]>5)return void delete this.loadSnap[e+t];setTimeout((function(){var i="/api/device/query/snap/"+e+"/"+t;s.loadSnap[e+t]++,document.getElementById(e+t).setAttribute("src",i+"?"+(new Date).getTime())}),1e3)}},showDevice:function(){this.$emit("show-device")},changeSubchannel:function(e){var t=this;this.beforeUrl=this.$router.currentRoute.path;var s="/".concat(this.$router.currentRoute.name,"/").concat(this.$router.currentRoute.params.deviceId,"/").concat(e.deviceId);this.$router.push(s).then((function(){t.searchStr="",t.channelType="",t.online="",t.initParam(),t.initData()}))},showSubChannels:function(){var e=this;this.$store.dispatch("device/querySubChannels",[{page:this.currentPage,count:this.count,query:this.searchStr,online:this.online,channelType:this.channelType},this.deviceId,this.parentChannelId]).then((function(t){e.total=t.total,e.deviceChannelList=t.list,e.deviceChannelList.forEach((function(e){e.ptzType=e.ptzType+""})),e.$nextTick((function(){e.$refs.channelListTable.doLayout()}))}))},search:function(){this.currentPage=1,this.total=0,this.initData()},updateChannel:function(e){this.$store.dispatch("device/changeChannelAudio",{channelId:e.id,audio:e.hasAudio})},subStreamChange:function(){var e=this;this.$confirm("确定重置所有通道的码流类型?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$store.dispatch("device/updateChannelStreamIdentification",{deviceDbId:e.device.id,streamIdentification:e.subStream}).then((function(t){e.initData()})).finally((function(){e.subStream=""}))})).catch((function(){e.subStream=""}))},channelSubStreamChange:function(e){var t=this;this.$store.dispatch("device/updateChannelStreamIdentification",{deviceDbId:e.deviceDbId,id:e.id,streamIdentification:e.streamIdentification}).then((function(e){t.initData()})).finally((function(){t.subStream=""}))},refresh:function(){this.initData()},handleEdit:function(e){this.editId=e.id},closeEdit:function(){this.editId=null,this.getDeviceChannelList()}}},q=G,H=Object(p["a"])(q,M,R,!1,null,null,null),W=H.exports,J={name:"Device",components:{deviceList:E,channelList:W},data:function(){return{deviceId:null}},methods:{showChannelList:function(e){this.deviceId=e},showDevice:function(){this.deviceId=null}}},K=J,Z=Object(p["a"])(K,i,a,!1,null,null,null);t["default"]=Z.exports},"28ce":function(e,t,s){"use strict";s("41d8")},"2b7e":function(e,t,s){},"34c9":function(e,t,s){"use strict";s("2b7e")},"408a":function(e,t,s){var i=s("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=i(e))throw TypeError("Incorrect invocation");return+e}},"41d8":function(e,t,s){},7295:function(e,t,s){},7317:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{id:"CommonChannelEdit"}},[s("el-form",{ref:"passwordForm",staticClass:"channel-form",attrs:{"status-icon":"","label-width":"160px"}},[s("div",{staticClass:"form-box"},[s("el-form-item",{attrs:{label:"名称"}},[s("el-input",{attrs:{placeholder:"请输入通道名称"},model:{value:e.form.gbName,callback:function(t){e.$set(e.form,"gbName",t)},expression:"form.gbName"}})],1),s("el-form-item",{attrs:{label:"编码"}},[s("el-input",{attrs:{placeholder:"请输入通道编码"},scopedSlots:e._u([{key:"append",fn:function(){return[s("el-button",{on:{click:function(t){return e.buildDeviceIdCode(e.form.gbDeviceId)}}},[e._v("生成")])]},proxy:!0}]),model:{value:e.form.gbDeviceId,callback:function(t){e.$set(e.form,"gbDeviceId",t)},expression:"form.gbDeviceId"}})],1),s("el-form-item",{attrs:{label:"设备厂商"}},[s("el-input",{attrs:{placeholder:"请输入设备厂商"},model:{value:e.form.gbManufacturer,callback:function(t){e.$set(e.form,"gbManufacturer",t)},expression:"form.gbManufacturer"}})],1),s("el-form-item",{attrs:{label:"设备型号"}},[s("el-input",{attrs:{placeholder:"请输入设备型号"},model:{value:e.form.gbModel,callback:function(t){e.$set(e.form,"gbModel",t)},expression:"form.gbModel"}})],1),s("el-form-item",{attrs:{label:"行政区域"}},[s("el-input",{attrs:{placeholder:"请输入行政区域"},scopedSlots:e._u([{key:"append",fn:function(){return[s("el-button",{on:{click:function(t){return e.chooseCivilCode()}}},[e._v("选择")])]},proxy:!0}]),model:{value:e.form.gbCivilCode,callback:function(t){e.$set(e.form,"gbCivilCode",t)},expression:"form.gbCivilCode"}})],1),s("el-form-item",{attrs:{label:"安装地址"}},[s("el-input",{attrs:{placeholder:"请输入安装地址"},model:{value:e.form.gbAddress,callback:function(t){e.$set(e.form,"gbAddress",t)},expression:"form.gbAddress"}})],1),s("el-form-item",{attrs:{label:"子设备"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择是否有子设备"},model:{value:e.form.gbParental,callback:function(t){e.$set(e.form,"gbParental",t)},expression:"form.gbParental"}},[s("el-option",{attrs:{label:"有",value:1}}),s("el-option",{attrs:{label:"无",value:0}})],1)],1),s("el-form-item",{attrs:{label:"父节点编码"}},[s("el-input",{attrs:{placeholder:"请输入父节点编码或选择所属虚拟组织"},scopedSlots:e._u([{key:"append",fn:function(){return[s("el-button",{on:{click:function(t){return e.chooseGroup()}}},[e._v("选择")])]},proxy:!0}]),model:{value:e.form.gbParentId,callback:function(t){e.$set(e.form,"gbParentId",t)},expression:"form.gbParentId"}})],1),s("el-form-item",{attrs:{label:"设备状态"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择设备状态"},model:{value:e.form.gbStatus,callback:function(t){e.$set(e.form,"gbStatus",t)},expression:"form.gbStatus"}},[s("el-option",{attrs:{label:"在线",value:"ON"}}),s("el-option",{attrs:{label:"离线",value:"OFF"}})],1)],1),s("el-form-item",{attrs:{label:"经度"}},[s("el-input",{attrs:{placeholder:"请输入经度"},model:{value:e.form.gbLongitude,callback:function(t){e.$set(e.form,"gbLongitude",t)},expression:"form.gbLongitude"}})],1),s("el-form-item",{attrs:{label:"纬度"}},[s("el-input",{attrs:{placeholder:"请输入纬度"},model:{value:e.form.gbLatitude,callback:function(t){e.$set(e.form,"gbLatitude",t)},expression:"form.gbLatitude"}})],1),s("el-form-item",{attrs:{label:"云台类型"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择云台类型"},model:{value:e.form.gbPtzType,callback:function(t){e.$set(e.form,"gbPtzType",t)},expression:"form.gbPtzType"}},[s("el-option",{attrs:{label:"球机",value:1}}),s("el-option",{attrs:{label:"半球",value:2}}),s("el-option",{attrs:{label:"固定枪机",value:3}}),s("el-option",{attrs:{label:"遥控枪机",value:4}}),s("el-option",{attrs:{label:"遥控半球",value:5}}),s("el-option",{attrs:{label:"多目设备的全景/拼接通道",value:6}}),s("el-option",{attrs:{label:"多目设备的分割通道",value:7}})],1)],1)],1),s("div",[s("el-form-item",{attrs:{label:"警区"}},[s("el-input",{attrs:{placeholder:"请输入警区"},model:{value:e.form.gbBlock,callback:function(t){e.$set(e.form,"gbBlock",t)},expression:"form.gbBlock"}})],1),s("el-form-item",{attrs:{label:"设备归属"}},[s("el-input",{attrs:{placeholder:"请输入设备归属"},model:{value:e.form.gbOwner,callback:function(t){e.$set(e.form,"gbOwner",t)},expression:"form.gbOwner"}})],1),s("el-form-item",{attrs:{label:"信令安全模式"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择信令安全模式"},model:{value:e.form.gbSafetyWay,callback:function(t){e.$set(e.form,"gbSafetyWay",t)},expression:"form.gbSafetyWay"}},[s("el-option",{attrs:{label:"不采用",value:0}}),s("el-option",{attrs:{label:"S/MIME签名",value:2}}),s("el-option",{attrs:{label:"S/MIME加密签名同时采用",value:3}}),s("el-option",{attrs:{label:"数字摘要",value:4}})],1)],1),s("el-form-item",{attrs:{label:"注册方式"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择注册方式"},model:{value:e.form.gbRegisterWay,callback:function(t){e.$set(e.form,"gbRegisterWay",t)},expression:"form.gbRegisterWay"}},[s("el-option",{attrs:{label:"IETFRFC3261标准",value:1}}),s("el-option",{attrs:{label:"基于口令的双向认证",value:2}}),s("el-option",{attrs:{label:"基于数字证书的双向认证注册",value:3}})],1)],1),s("el-form-item",{attrs:{label:"证书序列号"}},[s("el-input",{attrs:{type:"number",placeholder:"请输入证书序列号"},model:{value:e.form.gbCertNum,callback:function(t){e.$set(e.form,"gbCertNum",t)},expression:"form.gbCertNum"}})],1),s("el-form-item",{attrs:{label:"证书有效标识"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择证书有效标识"},model:{value:e.form.gbCertifiable,callback:function(t){e.$set(e.form,"gbCertifiable",t)},expression:"form.gbCertifiable"}},[s("el-option",{attrs:{label:"有效",value:1}}),s("el-option",{attrs:{label:"无效",value:0}})],1)],1),s("el-form-item",{attrs:{label:"无效原因码"}},[s("el-input",{attrs:{type:"errCode",placeholder:"请输入无效原因码"},model:{value:e.form.gbCertNum,callback:function(t){e.$set(e.form,"gbCertNum",t)},expression:"form.gbCertNum"}})],1),s("el-form-item",{attrs:{label:"证书终止有效期"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.form.gbEndTime,callback:function(t){e.$set(e.form,"gbEndTime",t)},expression:"form.gbEndTime"}})],1),s("el-form-item",{attrs:{label:"保密属性"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择保密属性"},model:{value:e.form.gbSecrecy,callback:function(t){e.$set(e.form,"gbSecrecy",t)},expression:"form.gbSecrecy"}},[s("el-option",{attrs:{label:"不涉密",value:0}}),s("el-option",{attrs:{label:"涉密",value:1}})],1)],1),s("el-form-item",{attrs:{label:"IP地址"}},[s("el-input",{attrs:{placeholder:"请输入IP地址"},model:{value:e.form.gbIpAddress,callback:function(t){e.$set(e.form,"gbIpAddress",t)},expression:"form.gbIpAddress"}})],1),s("el-form-item",{attrs:{label:"端口"}},[s("el-input",{attrs:{type:"number",placeholder:"请输入端口"},model:{value:e.form.gbPort,callback:function(t){e.$set(e.form,"gbPort",t)},expression:"form.gbPort"}})],1),s("el-form-item",{attrs:{label:"设备口令"}},[s("el-input",{attrs:{placeholder:"请输入设备口令"},model:{value:e.form.gbPassword,callback:function(t){e.$set(e.form,"gbPassword",t)},expression:"form.gbPassword"}})],1)],1),s("div",[s("el-form-item",{attrs:{label:"业务分组编号"}},[s("el-input",{attrs:{placeholder:"请输入业务分组编号"},model:{value:e.form.gbBusinessGroupId,callback:function(t){e.$set(e.form,"gbBusinessGroupId",t)},expression:"form.gbBusinessGroupId"}})],1),s("el-form-item",{attrs:{label:"位置类型"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择位置类型"},model:{value:e.form.gbPositionType,callback:function(t){e.$set(e.form,"gbPositionType",t)},expression:"form.gbPositionType"}},[s("el-option",{attrs:{label:"省际检查站",value:1}}),s("el-option",{attrs:{label:"党政机关",value:2}}),s("el-option",{attrs:{label:"车站码头",value:3}}),s("el-option",{attrs:{label:"中心广场",value:4}}),s("el-option",{attrs:{label:"体育场馆",value:5}}),s("el-option",{attrs:{label:"商业中心",value:6}}),s("el-option",{attrs:{label:"宗教场所",value:7}}),s("el-option",{attrs:{label:"校园周边",value:8}}),s("el-option",{attrs:{label:"治安复杂区域",value:9}}),s("el-option",{attrs:{label:"交通干线",value:10}})],1)],1),s("el-form-item",{attrs:{label:"室外/室内"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择位置类型"},model:{value:e.form.gbRoomType,callback:function(t){e.$set(e.form,"gbRoomType",t)},expression:"form.gbRoomType"}},[s("el-option",{attrs:{label:"室外",value:1}}),s("el-option",{attrs:{label:"室内",value:2}})],1)],1),s("el-form-item",{attrs:{label:"用途"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择位置类型"},model:{value:e.form.gbUseType,callback:function(t){e.$set(e.form,"gbUseType",t)},expression:"form.gbUseType"}},[s("el-option",{attrs:{label:"治安",value:1}}),s("el-option",{attrs:{label:"交通",value:2}}),s("el-option",{attrs:{label:"重点",value:3}})],1)],1),s("el-form-item",{attrs:{label:"补光"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择位置类型"},model:{value:e.form.gbSupplyLightType,callback:function(t){e.$set(e.form,"gbSupplyLightType",t)},expression:"form.gbSupplyLightType"}},[s("el-option",{attrs:{label:"无补光",value:1}}),s("el-option",{attrs:{label:"红外补光",value:2}}),s("el-option",{attrs:{label:"白光补光",value:3}}),s("el-option",{attrs:{label:"激光补光",value:4}}),s("el-option",{attrs:{label:"其他",value:9}})],1)],1),s("el-form-item",{attrs:{label:"监视方位"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择位置类型"},model:{value:e.form.gbDirectionType,callback:function(t){e.$set(e.form,"gbDirectionType",t)},expression:"form.gbDirectionType"}},[s("el-option",{attrs:{label:"东(西向东)",value:1}}),s("el-option",{attrs:{label:"西(东向西)",value:2}}),s("el-option",{attrs:{label:"南(北向南)",value:3}}),s("el-option",{attrs:{label:"北(南向北)",value:4}}),s("el-option",{attrs:{label:"东南(西北到东南)",value:5}}),s("el-option",{attrs:{label:"东北(西南到东北)",value:6}}),s("el-option",{attrs:{label:"西南(东北到西南)",value:7}}),s("el-option",{attrs:{label:"西北(东南到西北)",value:8}})],1)],1),s("el-form-item",{attrs:{label:"分辨率"}},[s("el-input",{attrs:{placeholder:"请输入分辨率"},model:{value:e.form.gbResolution,callback:function(t){e.$set(e.form,"gbResolution",t)},expression:"form.gbResolution"}})],1),s("el-form-item",{attrs:{label:"下载倍速"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择位置类型"},model:{value:e.form.gbDownloadSpeedArray,callback:function(t){e.$set(e.form,"gbDownloadSpeedArray",t)},expression:"form.gbDownloadSpeedArray"}},[s("el-option",{attrs:{label:"1倍速",value:"1"}}),s("el-option",{attrs:{label:"2倍速",value:"2"}}),s("el-option",{attrs:{label:"4倍速",value:"4"}}),s("el-option",{attrs:{label:"8倍速",value:"8"}}),s("el-option",{attrs:{label:"16倍速",value:"16"}})],1)],1),s("el-form-item",{attrs:{label:"空域编码能力"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择空域编码能力"},model:{value:e.form.gbSvcSpaceSupportMod,callback:function(t){e.$set(e.form,"gbSvcSpaceSupportMod",t)},expression:"form.gbSvcSpaceSupportMod"}},[s("el-option",{attrs:{label:"1级增强",value:"1"}}),s("el-option",{attrs:{label:"2级增强",value:"2"}}),s("el-option",{attrs:{label:"3级增强",value:"3"}})],1)],1),s("el-form-item",{attrs:{label:"时域编码能力"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择空域编码能力"},model:{value:e.form.gbSvcTimeSupportMode,callback:function(t){e.$set(e.form,"gbSvcTimeSupportMode",t)},expression:"form.gbSvcTimeSupportMode"}},[s("el-option",{attrs:{label:"1级增强",value:"1"}}),s("el-option",{attrs:{label:"2级增强",value:"2"}}),s("el-option",{attrs:{label:"3级增强",value:"3"}})],1)],1),s("div",{staticStyle:{float:"right"}},[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")]),e.cancel?s("el-button",{on:{click:e.cancelSubmit}},[e._v("取消")]):e._e(),1===e.form.dataType?s("el-button",{on:{click:e.reset}},[e._v("重置")]):e._e()],1)],1)]),s("channelCode",{ref:"channelCode"}),s("chooseCivilCode",{ref:"chooseCivilCode"}),s("chooseGroup",{ref:"chooseGroup"})],1)},a=[],o=(s("a15b"),s("d3b7"),s("165c")),n=s("363b"),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"chooseGroup"}},[s("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"选择虚拟组织",width:"30%",top:"5rem","append-to-body":!0,"close-on-click-modal":!1,visible:e.showDialog,"destroy-on-close":!0},on:{"update:visible":function(t){e.showDialog=t},close:function(t){return e.close()}}},[s("GroupTree",{ref:"regionTree",attrs:{"show-header":!0,edit:!0,"enable-add-channel":!1,"click-event":e.treeNodeClickEvent,"on-channel-change":e.onChannelChange,"tree-height":"45vh"}}),s("el-form",[s("el-form-item",[s("div",{staticStyle:{"text-align":"right"}},[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")]),s("el-button",{on:{click:e.close}},[e._v("取消")])],1)])],1)],1)],1)},l=[],c=s("a888"),d=s("c2c8"),u={name:"ChooseCivilCode",directives:{elDragDialog:c["a"]},components:{GroupTree:d["a"]},props:{},data:function(){return{showDialog:!1,endCallback:!1,groupDeviceId:"",businessGroup:""}},computed:{},created:function(){},methods:{openDialog:function(e){this.showDialog=!0,this.endCallback=e},onSubmit:function(){this.endCallback&&this.endCallback(this.groupDeviceId,this.businessGroup),this.close()},close:function(){this.showDialog=!1},treeNodeClickEvent:function(e){""!==e.deviceId&&e.deviceId!==e.businessGroup&&(this.groupDeviceId=e.deviceId,this.businessGroup=e.businessGroup)},onChannelChange:function(e){}}},m=u,h=s("2877"),p=Object(h["a"])(m,r,l,!1,null,null,null),f=p.exports,v={name:"CommonChannelEdit",components:{ChooseCivilCode:n["a"],ChooseGroup:f,channelCode:o["a"]},props:["id","dataForm","saveSuccess","cancel"],data:function(){return{loading:!1,form:{}}},created:function(){this.id?this.getCommonChannel():(this.dataForm.gbDeviceId||(this.dataForm.gbDeviceId=""),console.log(this.dataForm),this.form=this.dataForm)},methods:{onSubmit:function(){var e=this;this.loading=!0,this.form.gbDownloadSpeedArray&&(this.form.gbDownloadSpeed=this.form.gbDownloadSpeedArray.join("/")),this.form.gbId?this.$store.dispatch("commonChanel/update",this.form).then((function(t){e.$message.success({showClose:!0,message:"保存成功"}),e.saveSuccess&&e.saveSuccess()})).finally((function(){return[e.loading=!1]})):this.$store.dispatch("commonChanel/add",this.form).then((function(t){e.$message.success({showClose:!0,message:"保存成功"}),e.saveSuccess&&e.saveSuccess()})).finally((function(){return[e.loading=!1]}))},reset:function(){var e=this;this.$confirm("确定重置为默认内容?","提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,e.$axios({method:"post",url:"/api/common/channel/reset",params:{id:e.form.gbId}}).then((function(t){0===t.data.code&&(e.$message.success({showClose:!0,message:"重置成功 已保存"}),e.getCommonChannel())})).catch((function(e){console.error(e)})).finally((function(){return[e.loading=!1]}))})).catch((function(){}))},getCommonChannel:function(){var e=this;this.loading=!0,this.$store.dispatch("commonChanel/queryOne",this.id).then((function(t){t.gbDownloadSpeed&&(t.gbDownloadSpeedArray=t.gbDownloadSpeed.split("/")),e.form=t})).finally((function(){e.loading=!1}))},buildDeviceIdCode:function(e){var t=this;this.$refs.channelCode.openDialog((function(e){console.log(t.form),console.log("code===> "+e),t.form.gbDeviceId=e,console.log("code22===> "+e)}),e)},chooseCivilCode:function(){var e=this;this.$refs.chooseCivilCode.openDialog((function(t){e.form.gbCivilCode=t}))},chooseGroup:function(){var e=this;this.$refs.chooseGroup.openDialog((function(t,s){e.form.gbBusinessGroupId=s,e.form.gbParentId=t}))},cancelSubmit:function(){this.cancel&&this.cancel()}}},g=v,b=(s("257e"),Object(h["a"])(g,i,a,!1,null,null,null));t["a"]=b.exports},a135:function(e,t,s){"use strict";s("b21a")},a15b:function(e,t,s){"use strict";var i=s("23e7"),a=s("44ad"),o=s("fc6a"),n=s("a640"),r=[].join,l=a!=Object,c=n("join",",");i({target:"Array",proto:!0,forced:l||!c},{join:function(e){return r.call(o(this),void 0===e?",":e)}})},b21a:function(e,t,s){},b680:function(e,t,s){"use strict";var i=s("23e7"),a=s("a691"),o=s("408a"),n=s("1148"),r=s("d039"),l=1..toFixed,c=Math.floor,d=function(e,t,s){return 0===t?s:t%2===1?d(e,t-1,s*e):d(e*e,t/2,s)},u=function(e){var t=0,s=e;while(s>=4096)t+=12,s/=4096;while(s>=2)t+=1,s/=2;return t},m=l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r((function(){l.call({})}));i({target:"Number",proto:!0,forced:m},{toFixed:function(e){var t,s,i,r,l=o(this),m=a(e),h=[0,0,0,0,0,0],p="",f="0",v=function(e,t){var s=-1,i=t;while(++s<6)i+=e*h[s],h[s]=i%1e7,i=c(i/1e7)},g=function(e){var t=6,s=0;while(--t>=0)s+=h[t],h[t]=c(s/e),s=s%e*1e7},b=function(){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==h[e]){var s=String(h[e]);t=""===t?s:t+n.call("0",7-s.length)+s}return t};if(m<0||m>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(p="-",l=-l),l>1e-21)if(t=u(l*d(2,69,1))-69,s=t<0?l*d(2,-t,1):l/d(2,t,1),s*=4503599627370496,t=52-t,t>0){v(0,s),i=m;while(i>=7)v(1e7,0),i-=7;v(d(10,i,1),0),i=t-1;while(i>=23)g(1<<23),i-=23;g(1<<i),v(1,1),g(2),f=b()}else v(0,s),v(1<<-t,0),f=b()+n.call("0",m);return m>0?(r=f.length,f=p+(r<=m?"0."+n.call("0",m-r)+f:f.slice(0,r-m)+"."+f.slice(r-m))):f=p+f,f}})},d017:function(e,t,s){},e8b4:function(e,t,s){"use strict";s("0868")},e9c4:function(e,t,s){var i=s("23e7"),a=s("d066"),o=s("d039"),n=a("JSON","stringify"),r=/[\uD800-\uDFFF]/g,l=/^[\uD800-\uDBFF]$/,c=/^[\uDC00-\uDFFF]$/,d=function(e,t,s){var i=s.charAt(t-1),a=s.charAt(t+1);return l.test(e)&&!c.test(a)||c.test(e)&&!l.test(i)?"\\u"+e.charCodeAt(0).toString(16):e},u=o((function(){return'"\\udf06\\ud834"'!==n("\udf06\ud834")||'"\\udead"'!==n("\udead")}));n&&i({target:"JSON",stat:!0,forced:u},{stringify:function(e,t,s){var i=n.apply(null,arguments);return"string"==typeof i?i.replace(r,d):i}})},fdc8:function(e,t,s){"use strict";s("7295")}}]);